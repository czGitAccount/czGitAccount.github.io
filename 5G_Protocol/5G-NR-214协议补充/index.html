<!-- build time:Wed Jun 30 2021 17:24:24 GMT+0800 (GMT+08:00) --><!DOCTYPE html><html class="theme-next muse use-motion" lang="zh-Hans"><head><meta charset="UTF-8"><meta http-equiv="X-UA-Compatible" content="IE=edge"><meta name="viewport" content="width=device-width,initial-scale=1,maximum-scale=1"><meta name="theme-color" content="#222"><script src="/lib/pace/pace.min.js?v=1.0.2"></script><link href="/lib/pace/pace-theme-bounce.min.css?v=1.0.2" rel="stylesheet"><meta http-equiv="Cache-Control" content="no-transform"><meta http-equiv="Cache-Control" content="no-siteapp"><link href="/lib/fancybox/source/jquery.fancybox.css?v=2.1.5" rel="stylesheet" type="text/css"><link href="/lib/font-awesome/css/font-awesome.min.css?v=4.6.2" rel="stylesheet" type="text/css"><link href="/css/main.css?v=5.1.4" rel="stylesheet" type="text/css"><link rel="apple-touch-icon" sizes="180x180" href="/images/apple-touch-icon-next.png?v=5.1.4"><link rel="icon" type="image/png" sizes="32x32" href="/images/favicon.jpg?v=5.1.4"><link rel="icon" type="image/png" sizes="16x16" href="/images/favicon-16x16-next.png?v=5.1.4"><link rel="mask-icon" href="/images/logo.svg?v=5.1.4" color="#222"><meta name="keywords" content="TS 38.214,"><meta property="og:type" content="article"><meta property="og:title" content="5G-NR-214协议补充"><meta property="og:url" content="https://czgitaccount.github.io/5G_Protocol/5G-NR-214%E5%8D%8F%E8%AE%AE%E8%A1%A5%E5%85%85/index.html"><meta property="og:site_name" content="CongZ&#39;s Blog"><meta property="og:image" content="https://czgitaccount.github.io/5G_Protocol/5G-NR-214%E5%8D%8F%E8%AE%AE%E8%A1%A5%E5%85%85/p2-%E7%A0%81%E6%9C%AC%E4%BC%A0%E8%BE%93.png"><meta property="og:image" content="https://czgitaccount.github.io/5G_Protocol/5G-NR-214%E5%8D%8F%E8%AE%AE%E8%A1%A5%E5%85%85/p3-%E9%9D%9E%E7%A0%81%E6%9C%AC%E4%BC%A0%E8%BE%93.png"><meta property="og:image" content="https://czgitaccount.github.io/5G_Protocol/5G-NR-214%E5%8D%8F%E8%AE%AE%E8%A1%A5%E5%85%85/t1-214-4.1-1.png"><meta property="og:image" content="https://czgitaccount.github.io/5G_Protocol/5G-NR-214%E5%8D%8F%E8%AE%AE%E8%A1%A5%E5%85%85/t2-214-4.1-2.png"><meta property="og:image" content="https://czgitaccount.github.io/5G_Protocol/5G-NR-214%E5%8D%8F%E8%AE%AE%E8%A1%A5%E5%85%85/t3-214-5.1.2.1-1.png"><meta property="og:image" content="https://czgitaccount.github.io/5G_Protocol/5G-NR-214%E5%8D%8F%E8%AE%AE%E8%A1%A5%E5%85%85/t4-214-5.1.2.1-2.png"><meta property="og:image" content="https://czgitaccount.github.io/5G_Protocol/5G-NR-214%E5%8D%8F%E8%AE%AE%E8%A1%A5%E5%85%85/t5-214-5.1.2.1.1-1.png"><meta property="og:image" content="https://czgitaccount.github.io/5G_Protocol/5G-NR-214%E5%8D%8F%E8%AE%AE%E8%A1%A5%E5%85%85/t6-214-5.1.2.1.1-2.png"><meta property="og:image" content="https://czgitaccount.github.io/5G_Protocol/5G-NR-214%E5%8D%8F%E8%AE%AE%E8%A1%A5%E5%85%85/t7-214-5.1.2.1.1-3.png"><meta property="og:image" content="https://czgitaccount.github.io/5G_Protocol/5G-NR-214%E5%8D%8F%E8%AE%AE%E8%A1%A5%E5%85%85/t8-214-5.1.2.1.1-4.png"><meta property="og:image" content="https://czgitaccount.github.io/5G_Protocol/5G-NR-214%E5%8D%8F%E8%AE%AE%E8%A1%A5%E5%85%85/t9-214-5.1.2.1.1-4.png"><meta property="og:image" content="https://czgitaccount.github.io/5G_Protocol/5G-NR-214%E5%8D%8F%E8%AE%AE%E8%A1%A5%E5%85%85/t10-214-5.1.2.2.1-1.png"><meta property="og:image" content="https://czgitaccount.github.io/5G_Protocol/5G-NR-214%E5%8D%8F%E8%AE%AE%E8%A1%A5%E5%85%85/p1-%E6%91%98%E6%8A%841.png"><meta property="og:image" content="https://czgitaccount.github.io/5G_Protocol/5G-NR-214%E5%8D%8F%E8%AE%AE%E8%A1%A5%E5%85%85/t11-214-5.1.3.1-2.png"><meta property="og:image" content="https://czgitaccount.github.io/5G_Protocol/5G-NR-214%E5%8D%8F%E8%AE%AE%E8%A1%A5%E5%85%85/t12-214-5.1.3.1-3.png"><meta property="og:image" content="https://czgitaccount.github.io/5G_Protocol/5G-NR-214%E5%8D%8F%E8%AE%AE%E8%A1%A5%E5%85%85/t13-214-5.1.3.1-1.png"><meta property="article:published_time" content="2020-05-04T09:57:38.000Z"><meta property="article:modified_time" content="2021-06-22T08:07:53.506Z"><meta property="article:author" content="从之丶"><meta property="article:tag" content="TS 38.214"><meta name="twitter:card" content="summary"><meta name="twitter:image" content="https://czgitaccount.github.io/5G_Protocol/5G-NR-214%E5%8D%8F%E8%AE%AE%E8%A1%A5%E5%85%85/p2-%E7%A0%81%E6%9C%AC%E4%BC%A0%E8%BE%93.png"><script type="text/javascript" id="hexo.configurations">var NexT=window.NexT||{},CONFIG={root:"/",scheme:"Muse",version:"5.1.4",sidebar:{position:"left",display:"post",offset:12,b2t:!1,scrollpercent:"ture",onmobile:!1},fancybox:!0,tabs:!0,motion:{enable:!0,async:!1,transition:{post_block:"fadeIn",post_header:"slideDownIn",post_body:"slideDownIn",coll_header:"slideLeftIn",sidebar:"slideUpIn"}},duoshuo:{userId:"0",author:"博主"},algolia:{applicationID:"",apiKey:"",indexName:"",hits:{per_page:10},labels:{input_placeholder:"Search for Posts",hits_empty:"We didn't find any results for the search: ${query}",hits_stats:"${hits} results found in ${time} ms"}}}</script><link rel="canonical" href="https://czGitAccount.github.io/5G_Protocol/5G-NR-214协议补充/"><title>5G-NR-214协议补充 | CongZ's Blog</title><meta name="generator" content="Hexo 4.2.0"></head><body itemscope itemtype="http://schema.org/WebPage" lang="zh-Hans"><div class="container sidebar-position-left page-post-detail"><div class="headband"></div><header id="header" class="header" itemscope itemtype="http://schema.org/WPHeader"><div class="header-inner"><div class="site-brand-wrapper"><div class="site-meta"><div class="custom-logo-site-title"><a href="/" class="brand" rel="start"><span class="logo-line-before"><i></i></span> <span class="site-title">CongZ's Blog</span> <span class="logo-line-after"><i></i></span></a></div><p class="site-subtitle">择其善者而从之，其不善者而改之 !</p></div><div class="site-nav-toggle"><button><span class="btn-bar"></span> <span class="btn-bar"></span> <span class="btn-bar"></span></button></div></div><nav class="site-nav"><ul id="menu" class="menu"><li class="menu-item menu-item-home"><a href="/" rel="section"><i class="menu-item-icon fa fa-fw fa-home"></i><br>首页</a></li><li class="menu-item menu-item-tags"><a href="/tags/" rel="section"><i class="menu-item-icon fa fa-fw fa-tags"></i><br>标签</a></li><li class="menu-item menu-item-categories"><a href="/categories/" rel="section"><i class="menu-item-icon fa fa-fw fa-th"></i><br>分类</a></li><li class="menu-item menu-item-archives"><a href="/archives/" rel="section"><i class="menu-item-icon fa fa-fw fa-archive"></i><br>归档</a></li><li class="menu-item menu-item-about"><a href="/about/" rel="section"><i class="menu-item-icon fa fa-fw fa-user"></i><br>关于</a></li><li class="menu-item menu-item-search"><a href="javascript:;" class="popup-trigger"><i class="menu-item-icon fa fa-search fa-fw"></i><br>搜索</a></li></ul><div class="site-search"><div class="popup search-popup local-search-popup"><div class="local-search-header clearfix"><span class="search-icon"><i class="fa fa-search"></i> </span><span class="popup-btn-close"><i class="fa fa-times-circle"></i></span><div class="local-search-input-wrapper"><input autocomplete="off" placeholder="搜索..." spellcheck="false" type="text" id="local-search-input"></div></div><div id="local-search-result"></div></div></div></nav></div></header><main id="main" class="main"><div class="main-inner"><div class="content-wrap"><div id="content" class="content"><div id="posts" class="posts-expand"><article class="post post-type-normal" itemscope itemtype="http://schema.org/Article"><div class="post-block"><link itemprop="mainEntityOfPage" href="https://czGitAccount.github.io/5G_Protocol/5G-NR-214%E5%8D%8F%E8%AE%AE%E8%A1%A5%E5%85%85/"><span hidden itemprop="author" itemscope itemtype="http://schema.org/Person"><meta itemprop="name" content="从之丶"><meta itemprop="description" content=""><meta itemprop="image" content="/images/logo.jpg"></span><span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization"><meta itemprop="name" content="CongZ's Blog"></span><header class="post-header"><h1 class="post-title" itemprop="name headline">5G-NR-214协议补充</h1><div class="post-meta"><span class="post-time"><span class="post-meta-item-icon"><i class="fa fa-calendar-o"></i> </span><span class="post-meta-item-text">发表于</span> <time title="创建于" itemprop="dateCreated datePublished" datetime="2020-05-04T17:57:38+08:00">2020-05-04 </time></span><span class="post-category"><span class="post-meta-divider">|</span> <span class="post-meta-item-icon"><i class="fa fa-folder-o"></i> </span><span class="post-meta-item-text">分类于</span> <span itemprop="about" itemscope itemtype="http://schema.org/Thing"><a href="/categories/5G-Protocol/" itemprop="url" rel="index"><span itemprop="name">5G_Protocol</span></a></span></span><div class="post-wordcount"><span class="post-meta-item-icon"><i class="fa fa-file-word-o"></i> </span><span class="post-meta-item-text">字数统计&#58;</span> <span title="字数统计">5.1k </span><span class="post-meta-divider">|</span> <span class="post-meta-item-icon"><i class="fa fa-clock-o"></i> </span><span class="post-meta-item-text">阅读时长 &asymp;</span> <span title="阅读时长">20</span></div></div></header><div class="post-body" itemprop="articleBody"><div class="out-img-topic"><img src="/5G_Protocol/5G-NR-214协议补充/教堂_山.jpg" class="img-topic"></div><div class="post-button text-center"><div>山中教堂</div></div><a id="more"></a><h1 id="上行传输模式"><a href="#上行传输模式" class="headerlink" title="上行传输模式"></a>上行传输模式</h1><h2 id="概述"><a href="#概述" class="headerlink" title="概述"></a>概述</h2><p>下行方向：NR中仅支持一种下行传输模式，即基于闭环 DMRS 的空分复用 PDSCH传输。单 UE 最多支持 8 个正交端口，8层传输 (1-4：单码字/5-8层：两码字)。PDSCH 的 DMRS 和 PDSCH 采用相同的预编码矩阵；基站调度 PDSCH 资源时，无需指示码本信息，也称为非码本 <em>Non-Codebook</em> 传输。<br>上行方向：NR 支持两种传输模式：基于码本和非码本的 PUSCH 传输。单层 UE 最多 4 层传输，单码字 (Transform Precoding，即DFT-S-OFDM，仅支持单层传输)。</p><ul><li>基于码本传输时，基站在 DCI 中指示预编码矩阵中的索引</li><li>基于非码本传输时，基站在 DCI 中通过 SRI (SRS 资源索引) 来表示 PUSCH 的预编码码字</li></ul><p>PUSCH 传输模式：码本和非码本<br>在RRC高层信令中 <em>PUSCH-Config</em> 配置 (UE-Specific)<br></p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">txconfig	ENUMERATED &#123;codebook,nonCodebook&#125;	OPTIONAL, -- Need S</span><br></pre></td></tr></table></figure><p></p><p>如果不配置 <em>txConfig</em> 的情况下，不能使用 DCI 0_1 格式调度 (单天线端口，在使用DCI 0_0 调度时，PUSCH 只能基于单天线端口传输)；<br>当配置为 <em>codebook</em> 传输时，NR 系统允许基站为 UE 最多配置一个用于基于码本上行传输 CSI 获取的 SRS 资源集，该 SRS 资源集内最多可配置两个 SRS 资源包含相同的 SRS 天线端口数。SRI的字段长度为 $\lceil log_2 (N_{SRS}) \rceil$。</p><h2 id="基于码本传输"><a href="#基于码本传输" class="headerlink" title="基于码本传输"></a>基于码本传输</h2><p>上行 PUSCH ，基于码本传输的总体流程示意，如下图所示：</p><ol><li>基站给UE配置 1 或 2 个 (根据UE能力) SRS 资源，UE 向基站发送用于基于码本的上行传输方案 CSI 获取 的 SRS ，基站进行上行 CSI 测量；</li><li>基站根据测量结果，确定 CSI 参数，包括选择的 SRS 资源 (SRI, SRS Resource Indicator) ，传输的预编码矩阵索引 (TPMI, Transmit Precoding Marrix Indicator) 和传输 Rank (TRI, Transmit Rank Indicator)，即上行传输的层数；进一步根据预编码矩阵和信道信息，确定出上行传输的 MCS 等级。</li><li>基站通过 DCI 信令，指示 UE 的CSI 参数，以及相应的 MCS 。</li><li>UE 根据基站指示的 MCS 对数据进行调制编码，并利用所指示的 SRI、TPMI 和 TRI 确定发送时使用的预编码矩阵和传输层数，进而对数据进行预编码及发送。PUSCH 的解调参考信号与PUSCH 的数据采用相同的预编码方式。</li><li>基站根据解调参考信号估计上行信道，并进行数据检测。</li></ol><p><img src="/5G_Protocol/5G-NR-214%E5%8D%8F%E8%AE%AE%E8%A1%A5%E5%85%85/p2-码本传输.png" alt></p><h2 id="基于非码本传输"><a href="#基于非码本传输" class="headerlink" title="基于非码本传输"></a>基于非码本传输</h2><p>非码本传输方案与基于码本的上行传输方案的区别在于其预编码不在限定于基于固定码本的有限候选集，UE 基于信道互易性确定上行预编码矩阵。若信道互易性足够好，UE 可以获得较优的上行预编码，相对于基于码本的传输方案，可以节省预编码指示的开销，同时获得更好的性能。</p><p>上行 PUSCH ，基于非码本传输的总体流程示意，如下图所示：</p><ol><li>UE测量下行参考信号，获得候选的上行预编码矩阵，利用他们对用于非码本上行传输方案的 SRS 进行预编码后将其发送给基站。</li><li>基站根据 UE 发送 的SRS 进行上行信道检测，对 UE 进行资源调度，确定出上行传输对应的 SRS 资源和上行传输的 MCS 等级等，并通知 UE。其中上行传输对应的 SRS 资源通过 SRI 指示给 UE。</li><li>UE 根据基站发送的 MSC 对数据进行调制编码，并利用 SRI 确定数据的预编码和传输层数，对数据进行预编码后进行数据的发送。非码本上行传输方案下的 PUSCH 解调惨老信号 于PUSCH 的数据采用相同的预编码方式。</li><li>基站根据解调参考信号估计上行信道，进行数据检测。</li></ol><p><img src="/5G_Protocol/5G-NR-214%E5%8D%8F%E8%AE%AE%E8%A1%A5%E5%85%85/p3-非码本传输.png" alt></p><p>对于非码本上行传输方案，基站可以为 UE 配置 1 个用于上行 CSI 获取的 SRS 资源集，包含 1~4 个 SRS 资源，每个 SRS 资源包含 1 个SRS 端口。SRI 可以指示一个或多个 SRS 资源，用于 PUSCH 预编码的确定。SRI 指示的 SRS 资源数即为 PUSCH 传输的流数，PUSCH 的传输层于 SRI 指示的 SRS 资源一一对应。<br>SRS 资源集配置中，关联一个 NZP CSI-RS 资源的 ID。</p><h2 id="PUSCH-信道预编码"><a href="#PUSCH-信道预编码" class="headerlink" title="PUSCH 信道预编码"></a>PUSCH 信道预编码</h2><p>根据如下公式对向量块$[y^{(0)}(i),…,y^{(v-1)}(i)]^{T},i = 0,1,…,M_{symb}^{layer}-1$ 进行预编码处理：</p><script type="math/tex;mode=display">\left[\begin{matrix} z^{(0)}(i)\\ \vdots\\ z^{(p-1)}(i) \end{matrix} \right]=W\left[\begin{matrix} y^{(0)}(i)\\ \vdots \\ y^{(p-1)}(i) \end{matrix} \right]</script><p>其中 $i = 0,1,…,M_{symb}^{ap} -1, M_{symb}^{ap} =M_{symb}^{layer}$ 。</p><p>RRC 参数如下：<br></p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">txConfig				ENUMERATED &#123;codebook,nonCodebook&#125;</span><br></pre></td></tr></table></figure><p></p><p>对于基于非码本的传输，预编码矩阵<strong>W</strong> 为单位矩阵。<br>对于基于码本的传输，预编码矩阵<strong>W</strong>：</p><ul><li><p>When number of layer = 1, number of antenna port = 1，<strong>W</strong> = 1。</p></li><li><p>When number of layer $\geq$ 1 and number of antenna port $\geq$ 2 ，</p><p>根据DCI 0-1中的 “Precoding information and number of layers” 确定预编码矩阵<strong>W</strong>(参考如下表格)：</p><blockquote><p>[TS 38.211 Table 6.3.1.5-1]<br>[TS 38.211 Table 6.3.1.5-2]<br>[TS 38.211 Table 6.3.1.5-3]<br>[TS 38.211 Table 6.3.1.5-4]<br>[TS 38.211 Table 6.3.1.5-5]<br>[TS 38.211 Table 6.3.1.5-6]<br>[TS 38.211 Table 6.3.1.5-7]</p></blockquote></li></ul><p>按照层数，天线端口数，是否配置变换预编码，三者的参数，选取预编码矩阵，总结成如下表格：</p><div class="table-container"><table><thead><tr><th>Number of Layers</th><th>Number of Antenna</th><th>Transform Precoding</th><th>Precoding Matrix</th></tr></thead><tbody><tr><td>1</td><td>2</td><td></td><td>211 Table 6.3.1.5-1</td></tr><tr><td>1</td><td>4</td><td>enabled</td><td>211 Table 6.3.1.5-2</td></tr><tr><td>1</td><td>4</td><td>disabled</td><td>211 Table 6.3.1.5-3</td></tr><tr><td>2</td><td>2</td><td>disabled</td><td>211 Table 6.3.1.5-4</td></tr><tr><td>2</td><td>4</td><td>disabled</td><td>211 Table 6.3.1.5-5</td></tr><tr><td>3</td><td>4</td><td>disabled</td><td>211 Table 6.3.1.5-6</td></tr><tr><td>4</td><td>4</td><td>disabled</td><td>211 Table 6.3.1.5-7</td></tr></tbody></table></div><h1 id="TS-38-214协议补充"><a href="#TS-38-214协议补充" class="headerlink" title="TS 38.214协议补充"></a>TS 38.214协议补充</h1><h2 id="1-下行链路的功率分配"><a href="#1-下行链路的功率分配" class="headerlink" title="1 下行链路的功率分配"></a>1 下行链路的功率分配</h2><p>下行传输的EPRE (Energy per resource element) 由基站确定。</p><ul><li>对于测量SS-RSRP，SS-RSRQ，SS-SINR来说，UE会假定整个带宽上的EPRE是恒定的。</li><li>对于测量SS-RSRP，SS-RSRQ，SS-SINR来说，UE会假定不同的SS/PBCH承载的SSS上的EPRE也是恒定的。</li><li>对于测量SS-RSRP，SS-RSRQ，SS-SINR来说，UE会假定SSS上的EPRE和 PBCH-DMRS上的EPRE之比为0 dB。</li><li>对于CSI-RSRP，CSI-RSRQ，CSI-SINR测量来说，UE会假定同一端口下给CSI所配置的所有下行带宽的EPRE是恒定的；所配置所有OFDM上的EPRE也是恒定的。</li></ul><p>下行SS/PBCH块上SSS 的EPRE可以从高层配置的SS/PBCH下行发送功率参数（<em>SS-PBCH-BlockPower</em>）得到。下行SSS传输功率被定义为系统带宽内所有承载了SSS的RE上的功率的线性平均值（单位[W]）。对于一个小区来讲，UE假定PSS EPRE与SSS EPRE比为0dB或者3dB。</p><p>下行CSI-RS的EPRE可以从高层配置的SS/PBCH下行发送功率参数（<em>SS-PBCH-BlockPower</em>）以及CSI-RS功率偏移参数（<em>powerControlOffsetSS</em>）得到。下行参考信号传输功率被定义为系统带宽内所有承载了CSI-RS的RE上的功率的线性平均值（单位[W]）。</p><p>对于PDSCH的解调参考信DMRS而言，UE会根据DCI配置的DMRS CDM组数量（除去数据）在下表中查找PDSCH EPRE与DMRS EPRE比。DMRS的缩放因子 $\beta_{PDSCH}^{DMRS}$ 由 [4, TS 38.211] 给出：$\beta_{PDSCH}^{DMRS}=10^{-\frac{\beta_{DMRS}}{20}}$。</p><p><img src="/5G_Protocol/5G-NR-214%E5%8D%8F%E8%AE%AE%E8%A1%A5%E5%85%85/t1-214-4.1-1.png" alt></p><p>当使用与PDSCH关联的PT-RS端口调度UE时，</p><ul><li>如果UE配置了高层参数 <em>epro-Ratio</em>，根据epre-Ratio，表4.1-2给出了PT-RS端口的每个RE的每层PT-RS EPRE与PDSCH EPRE的比率（$ρ_{PTRS}$），PTRS的缩放因子由 [4, TS 38.211] 给出：$\beta_{PTRS}=10^{\frac{\rho_{PTRS}}{20}}$；</li><li>否则，如果没有在表4.1-2配置，则UE将假定<em>epro-Ratio</em> 设置为状态 0 ；</li></ul><p><img src="/5G_Protocol/5G-NR-214%E5%8D%8F%E8%AE%AE%E8%A1%A5%E5%85%85/t2-214-4.1-2.png" alt></p><h2 id="2-物理下行链路共享信道相关流程"><a href="#2-物理下行链路共享信道相关流程" class="headerlink" title="2 物理下行链路共享信道相关流程"></a>2 物理下行链路共享信道相关流程</h2><h3 id="2-1-UE-用于接收物理下行链路共享信道的过程"><a href="#2-1-UE-用于接收物理下行链路共享信道的过程" class="headerlink" title="2.1 UE 用于接收物理下行链路共享信道的过程"></a>2.1 UE 用于接收物理下行链路共享信道的过程</h3><p>对于下行链路，UE 支持每个小区最多16 个HARQ 进程。UE 可以假设的进程的数量最多将用于下行链路，通过更高层参数 <em>nrofHARQ-processesForPDSCH</em> 分别为每个小区配置给UE，并且当没有提供配置时，UE 默认的8 个进程。</p><h4 id="2-1-1-传输方案"><a href="#2-1-1-传输方案" class="headerlink" title="2.1.1 传输方案"></a>2.1.1 传输方案</h4><p>PDSCH仅定义了一种传输方案，并且用于所有的PDSCH传输。<br>对于PDSCH传输方案1，UE可以假设将在天线端口 1000-1011 上多大 8 个传输层执行PDSCH 上的 gNB 传输 [参考 TS 38.211]</p><h3 id="2-1-2-资源分配"><a href="#2-1-2-资源分配" class="headerlink" title="2.1.2 资源分配"></a>2.1.2 资源分配</h3><h4 id="2-1-2-1-时域资源"><a href="#2-1-2-1-时域资源" class="headerlink" title="2.1.2.1 时域资源"></a>2.1.2.1 时域资源</h4><p>PDSCH时域资源的位置参考如下表格，分为mapping Type A 和mapping Type B 两种：</p><p><img src="/5G_Protocol/5G-NR-214%E5%8D%8F%E8%AE%AE%E8%A1%A5%E5%85%85/t3-214-5.1.2.1-1.png" alt></p><p>其中：</p><ul><li><em>S</em> 为PDSCH在时隙中的开始符号</li><li><em>L</em> 为PDSCH在时隙中的持续时间</li></ul><p><strong>PDSCH 信道重复发送</strong>：</p><p>当 UE 配置为 aggregationFactorDL &gt; 1 时，在 aggregationFactotDL 连续时隙上应用相同的符号分配。UE 可以预期在每个 aggregationFactorDL 连续时隙中的每个分配符号内重复发送 TB ，并且 PDSCH 限于单层传输，根据 [TS 38.214 Table 5.1.2.1-2] 确定要应用于 TB 的 $n^{th}$ 传输时刻的冗余版本。</p><p><img src="/5G_Protocol/5G-NR-214%E5%8D%8F%E8%AE%AE%E8%A1%A5%E5%85%85/t4-214-5.1.2.1-2.png" alt></p><p>如果调度 PDSCH 的 PDCCH 在同一个时隙内被接受，并且不在时隙的前三个符号内，则不期望 UE 在时隙中接收 mapping Type A 的 PDSCH。<br>如果调度PDSCH 的 PDCCH 的第一符号是在比 PDSCH 时域资源分配中指示的第一符号晚的符号中接收到的，则不期望UE在时隙中接收 mapping Type A 的 PDSCH。</p><h5 id="2-1-2-1-1-确定用于PDSCH的资源分配表"><a href="#2-1-2-1-1-确定用于PDSCH的资源分配表" class="headerlink" title="2.1.2.1.1 确定用于PDSCH的资源分配表"></a>2.1.2.1.1 确定用于PDSCH的资源分配表</h5><p>[Table 5.1.2.1.1-1~1A] 中定义了要应用的 PDSCH 时域资源分配配置。如果上层参数 <em>pdsch-TimeDomainAllocationList or Pdsch-TimeDomainAllocationList-ForDCIFormat1_2</em> 配置了，则使用相应的资源分配配置；如果为配置则使用[Table 5.1.2.1.1-2~5] 中默认的A B C 三种表格。</p><p><img src="/5G_Protocol/5G-NR-214%E5%8D%8F%E8%AE%AE%E8%A1%A5%E5%85%85/t5-214-5.1.2.1.1-1.png" alt></p><p><img src="/5G_Protocol/5G-NR-214%E5%8D%8F%E8%AE%AE%E8%A1%A5%E5%85%85/t6-214-5.1.2.1.1-2.png" alt></p><p><img src="/5G_Protocol/5G-NR-214%E5%8D%8F%E8%AE%AE%E8%A1%A5%E5%85%85/t7-214-5.1.2.1.1-3.png" alt></p><p><img src="/5G_Protocol/5G-NR-214%E5%8D%8F%E8%AE%AE%E8%A1%A5%E5%85%85/t8-214-5.1.2.1.1-4.png" alt></p><p><img src="/5G_Protocol/5G-NR-214%E5%8D%8F%E8%AE%AE%E8%A1%A5%E5%85%85/t9-214-5.1.2.1.1-4.png" alt></p><h4 id="5-1-2-2-频域资源分配"><a href="#5-1-2-2-频域资源分配" class="headerlink" title="5.1.2.2 频域资源分配"></a>5.1.2.2 频域资源分配</h4><p>和 LTE 类似，NR 的 PDSCH 信道频域资源分配，支持基于位图分配和基于RIV的分配 (Type 0 和 Type 1)，不再支持比较复杂的 LTE Type 1 型支持分配。</p><p>UE 应当假设当接收到具有 DCI 格式 1_0 的调度的 PDSCH，则使用下行链路资源分配 Type 1。</p><p>如果调度DCI 被配置为通过将pdsch-Config 中的更高层参数 <em>resourceAllocation</em> 设置为<em>‘dynamicswitch’</em>来指示下行链路资源分配类型作为频域资源分配字段的一部分，则UE 将根据此DCI 字段定义配置使用下行链路资源分配 Type 0 或 Type 1。否则，UE 将使用由更高层参数<em>resourceAllocation</em> 定义的下行链路频率资源分配类型。</p><p>对于在任何类型的 PDCCH 公共搜索空间中以DCI format 1_0 调度的PDSCH，无论哪个BWP是active BWP，RB 编号从其中接收 DCI 的CORESET 的最低 RB 开始。</p><p>对于其他调度的PDSCH：</p><ul><li>如果在调度DCI 中<strong>未配置</strong>带宽部分指示符字段，则在 UE 的有效带宽部分内确定用于下行链路 Type 0 和 Type 1 资源分配的RB 索引。</li><li>如果在调度DCI 中<strong>配置</strong>带宽部分指示符字段，则在DCI 中由带宽部分指示符字段值指示的UE 的带宽部分内确定用于下行链路Type 0 和 Type 1 资源分配的RB 索引。</li></ul><p>UE 在检测到预期用于UE 的PDCCH 时将首先确定下行链路载波带宽部分，然后确定带宽部分内的资源分配。</p><h5 id="2-1-2-2-1-下行链路资源分配-Type-0-bitmap"><a href="#2-1-2-2-1-下行链路资源分配-Type-0-bitmap" class="headerlink" title="2.1.2.2.1 下行链路资源分配 Type 0 (bitmap)"></a>2.1.2.2.1 下行链路资源分配 Type 0 (bitmap)</h5><p>在 Type 0 的下行链路资源分配中，资源块分配信息包括指示分配给调度的UE的资源块组 (RBG , Resource Block Groups )的bitmap，其中RBG是由较高层参数 <em>rbg-Size</em> 定义的一组连续的虚拟资源块。 由<em>PDSCH-Config</em>配置，BWP的大小如 [Table 5.1.2.2.1-1] 中所定义。</p><p><img src="/5G_Protocol/5G-NR-214%E5%8D%8F%E8%AE%AE%E8%A1%A5%E5%85%85/t10-214-5.1.2.2.1-1.png" alt></p><p>RBG 总数 ($N_{RBG}$) 对于大小为 $N_{BWP,i}^{size}$ 个PRB 的下行BWP i ，由下式给出：</p><script type="math/tex;mode=display">N_{RBG}=\lceil (N_{BWP,i}^{size}+(N_{BWP,i}^{start}modP))/p \rceil</script><p>其中：</p><ul><li>第一个 RBG 的大小是 $RBG_{0}^{size} = P- N_{BWP,i}^{start} mod P$；</li><li>最后一个 RBG 的大小是 $RBG_{last}^{size} = (N_{BWP,i}^{size}+N_{BWP,i}^{start} )mod P$，或者就是恰好为 $P$ ;</li><li>其他的RBG的大小是 <em>P</em> 。</li></ul><p>bitmap 的大小是 $N_{RBG}$ bits，并且每一个 RBG 都有一个bitmap 位，因此每个 RBG 都是可寻址的。RBG 应该是按照频率增加的顺序排序索引的，并从 BWP 的 最低频率开始。RBG bitmap 的映射顺序为：RBG 0 到 $RBG_{N_{RBG}}-1$，按照顺序映射从 bitmap 的 MSB 到 LSB。如果 对应的 bitmap 比特位是 1 ，则代表该 RBG 分配给 UE，否则反之。</p><h5 id="2-1-2-2-2-下行链路资源分配-Type-1-RIV"><a href="#2-1-2-2-2-下行链路资源分配-Type-1-RIV" class="headerlink" title="2.1.2.2.2 下行链路资源分配 Type 1 (RIV)"></a>2.1.2.2.2 下行链路资源分配 Type 1 (RIV)</h5><p>在 Type 1 的下行链路资源分配中，资源块指派信息向调度的 UE 指示在有效带宽部分大小 (三者中的一种情况$N_{BWP}^{size},N_{CORESET}^{size},N_{BWP,initial}^{size}$) 内的一组连续分配的非交织或交织的虚拟资源块。</p><p>下行链路 Type 1 资源分配字段包括与起始虚拟资源块 ($RB_{start}$) 相对应的资源指示值 (RIV , Resource Indication Value)，以及连续分配的资源块的长度 $L_{RBs}$。RIV 的最大长度和BWP带宽相关，由下式给出：</p><p>$if\quad (L_{RBs}-1)\leq \lfloor N_{BWP}^{size}/2 \rfloor \quad then$<br>$\quad RIV=N_{BWP}^{size}(L_{RBs}-1)+RB_{start}$<br>$else$<br>$\quad RIV=N_{BWP}^{size}(N_{BWP}^{size}-L_{RBs}+1)+(N_{BWP}^{size}-1-RB_{start})$</p><p>其中 $L_{RBs} \geq 1$ 并且 不应该超过 $N_{BWP}^{size} - RB_{start}$</p><p>两种频域资源分配方式比较：和 Type 0 相比，Type 1 分配的频域资源比较 “精确” ，最小粒度达到了 RB 级，缺点是只能分配连续的 RB 资源，不利于基于频选资源调度。</p><p><strong>DCI size 对齐后的调度</strong></p><p>当出现 DCI size 对齐操作后，在 USS 中使用DCI 1_0 调度的频域资源 (当前激活BWP中)，但DCI 1_0 长度来自于 CORESET 0 。 在这种情况下，如果当前激活BWP带宽大于CORESET 0 ，调度的频域资源要进行等比例 “放大”，放大系数 <em>K</em> 。</p><p><img src="/5G_Protocol/5G-NR-214%E5%8D%8F%E8%AE%AE%E8%A1%A5%E5%85%85/p1-摘抄1.png" alt></p><p>RIV 有如下式子获得：</p><p>$if\quad (L’_{RBs}-1)\leq \lfloor N_{BWP}^{initial}/2 \rfloor \quad then$<br>$\quad RIV=N_{BWP}^{initial}(L’_{RBs}-1)+RB’_{start}$<br>$else$<br>$\quad RIV=N_{BWP}^{initial}(N_{BWP}^{initial}-L’_{RBs}+1)+(N_{BWP}^{initial}-1-RB’_{start})$</p><p>其中：$L’_{RBs}=L_{RBs}/K,RB;_{start}=RB_{start}/k,L’_{RBs} \leq N_{BWP}^{initial}-RB’_{start}$</p><p>实际分配 RB 资源乘以系数 <em>K</em> ：</p><script type="math/tex;mode=display">RB_{start}=0,K,2\cdot K,...,(N_{BWP}^{initial}-1)\cdot K \\L_{RBs} = K,2\cdot K,...,N_{BWP}^{initial}\cdot K</script><h4 id="2-1-2-3-PDSCH信道PRB-bundling"><a href="#2-1-2-3-PDSCH信道PRB-bundling" class="headerlink" title="2.1.2.3 PDSCH信道PRB bundling"></a>2.1.2.3 PDSCH信道PRB bundling</h4><p>LTE中，下行 PDSCH 信道在分配的全部频域上使用相同的预编码；NR 中 ，PDSCH 信道在频域带宽很大，支持频域选择的预编码，即频域上不同的 PRB 范围可以采用不同的预编码矩阵。<br>采用相同预编码矩阵的一组 PRB 称为一个 PRG (Precoding Resource Block Group)，PRG的大小也成为 precoding granularity，第 <em>i</em> 个 BWP 内，预编码粒度用 $P’_{BWP,i}$ 表示；<br>$P’_{BWP,i}$ 通过高层信令配置，范围为 {2，4，wideband}</p><ul><li>$P’_{BWP,i}$ 配置为 wideband 时，UE只能接受连续RB分配，所有资源使用相同预编码；</li><li>$P’_{BWP,i}$ 配置为 2 / 4 时，BWP内按照 $P’_{BWP,i}$ 进行 RB 组分段，类似 BWP内的 RBG 分段</li></ul><p>DCI 1_0 调度时，$P’_{BWP,i} = 2$<br>DCI 1_1 调度时，$P’_{BWP,i}$ 和高层配置以及 DCI 字段相关，参考我之前PDSCH 的 PRB bundling 笔记。</p><h3 id="2-1-3-调制阶数，目标码率，冗余版本，传输块大小确定"><a href="#2-1-3-调制阶数，目标码率，冗余版本，传输块大小确定" class="headerlink" title="2.1.3 调制阶数，目标码率，冗余版本，传输块大小确定"></a>2.1.3 调制阶数，目标码率，冗余版本，传输块大小确定</h3><p>为了确定 PDSCH 的调制阶数，目标码率和传输块的大小，UE 应该<br>首先</p><ul><li>读取 DCI 中 5 bits MCS 字段 ($I_{MCS}$)，根据 [TS 38.214 5.1.3.1] 中定义的过程确定调制阶数 ($Q_m$) 和 目标码率 (R)</li><li>读取 DCI 中的冗余版本字段 (rv) 以确定冗余版本。<br>其次</li><li>UE 应使用层数 (<em>v</em>)，速率匹配之前分配的 PRB 总数 ($n_{PRB}$) ，以根据 [TS 38.214 5.1.3.2] 中定义的过程确定传输块的大小</li></ul><p>如果有效信道码率高于 0.95，则 UE 可以在初始传输中跳过解码传输块，其中有效信道码率被定义为下行链路信息比特 (包括CRC) 的数量除以PDSCH上物理信道比特数。</p><h4 id="2-1-3-1-调制阶数和目标码率确定"><a href="#2-1-3-1-调制阶数和目标码率确定" class="headerlink" title="2.1.3.1 调制阶数和目标码率确定"></a>2.1.3.1 调制阶数和目标码率确定</h4><p>对于由C-RNTI, MCS-C-RNTI, TC-RNTI, CS-RNTI, SI-RNTI, RA-RNTI, MsgB-RNTI, or P-RNTI 加扰的 DCI format 1_0 1_1 1_2 PDCCH 调度的PDSCH，或者对于使用更高层提供的PDSCH配置 <em>SPS-Config</em> 进行调度而没有相应的PDCCH传输的PDSCH。</p><p>如果 <em>PDSCH-Config</em> 给出的高层参数 <em>mcs-Table-ForDCIFormal1_2</em> 设置为 ‘<em>qam256</em>‘，则PDSCH 由 DCI format 1_2 的PDCCH 调度，并且 CRC 由 C-RNTI 加扰</p><ul><li>UE 应使用 <em>$I_{MCS}$</em> 和 [Table 5.1.3.1-2] 来确定PDSCH中使用的调制阶数 ($Q_m$) 和目标码率 (R)。</li></ul><p><img src="/5G_Protocol/5G-NR-214%E5%8D%8F%E8%AE%AE%E8%A1%A5%E5%85%85/t11-214-5.1.3.1-2.png" alt></p><p>再如果 UE 没有配置 MCS-C-RNTI，PDSCH-Config 给出的高层参数 <em>mcs-Table-ForDCIFormal1_2</em> 设置为 ‘<em>qam64LowSE</em>‘，且 PDSCH 由 DCI format 1_2 的PDCCH 调度，并且 CRC 由 C-RNTI 加扰</p><ul><li>UE 应使用 <em>$I_{MCS}$</em> 和 [Table 5.1.3.1-3] 来确定PDSCH中使用的调制阶数 ($Q_m$) 和目标码率 (R)。</li></ul><p><img src="/5G_Protocol/5G-NR-214%E5%8D%8F%E8%AE%AE%E8%A1%A5%E5%85%85/t12-214-5.1.3.1-3.png" alt></p><p>如果 <em>PDSCH-Config</em> 给出的高层参数 <em>mcs-Table</em> 设置为 ‘qam256’，则PDSCH 由 DCI format 1_1 的PDCCH 调度，并且 CRC 由 C-RNTI 加扰</p><ul><li>UE 应使用 <em>$I_{MCS}$</em> 和 [Table 5.1.3.1-2] 来确定PDSCH中使用的调制阶数 ($Q_m$) 和目标码率 (R)。</li></ul><p>再如果 UE 没有配置 MCS-C-RNTI，PDSCH-Config 给出的高层参数 <em>mcs-Table</em> 设置为 ‘<em>qam64LowSE</em>‘，且 PDSCH 由 DCI format 1_2 (UE-specific search space) 的PDCCH 调度，并且 CRC 由 C-RNTI 加扰</p><ul><li>UE 应使用 <em>$I_{MCS}$</em> 和 [Table 5.1.3.1-3] 来确定PDSCH中使用的调制阶数 ($Q_m$) 和目标码率 (R)。</li></ul><p>再如果 UE 配置 MCS-C-RNTI，且 PDSCH 由 PDCCH 调度，并且 CRC 由 MCS-C-RNTI 加扰</p><ul><li>UE 应使用 <em>$I_{MCS}$</em> 和 [Table 5.1.3.1-3] 来确定PDSCH中使用的调制阶数 ($Q_m$) 和目标码率 (R)。</li></ul><p>再如果 UE 未配置由<em>SPS-config</em> 给出的高层参数 <em>mcs-Table</em> ，由<em>PDSCH-Config</em> 给出的高层参数 <em>mcs-Table-ForDCIFormal1_2</em> 设置为 ‘qam256’，则PDSCH 由 DCI format 1_2 的PDCCH 调度，并且 CRC 由 CS-RNTI 加扰</p><ul><li>UE 应使用 <em>$I_{MCS}$</em> 和 [Table 5.1.3.1-2] 来确定PDSCH中使用的调制阶数 ($Q_m$) 和目标码率 (R)。</li></ul><p>再如果 UE 未配置由<em>SPS-config</em> 给出的高层参数 <em>mcs-Table</em> ，由<em>PDSCH-Config</em> 给出的高层参数 <em>mcs-Table</em> 设置为 ‘qam256’，</p><ul><li>如果 PDSCH 由 DCI format 1_1 (CS-RNTI 加扰) 的PDCCH 调度，或者</li><li>PDSCH 调度的没有相关的使用 <em>SPS-Config</em> 的PDSCH 传输<ul><li>UE 应使用 <em>$I_{MCS}$</em> 和 [Table 5.1.3.1-2] 来确定PDSCH中使用的调制阶数 ($Q_m$) 和目标码率 (R)。</li></ul></li></ul><p>再如果 UE 配置由<em>SPS-config</em> 给出的高层参数 <em>mcs-Table</em> ，并且 设置为 ‘<em>qam64LowSE</em>‘</p><ul><li>如果 PDSCH 由 (CS-RNTI 加扰) 的PDCCH调度，或者</li><li>PDSCH 调度的没有相关的使用 <em>SPS-Config</em> 的PDSCH 传输<ul><li>UE 应使用 <em>$I_{MCS}$</em> 和 [Table 5.1.3.1-3] 来确定PDSCH中使用的调制阶数 ($Q_m$) 和目标码率 (R)。</li></ul></li></ul><p>否则，</p><ul><li>UE 应使用 <em>$I_{MCS}$</em> 和 [Table 5.1.3.1-1] 来确定PDSCH中使用的调制阶数 ($Q_m$) 和目标码率 (R)。</li></ul><p><img src="/5G_Protocol/5G-NR-214%E5%8D%8F%E8%AE%AE%E8%A1%A5%E5%85%85/t13-214-5.1.3.1-1.png" alt></p><p>不期望UE 解码用 P-RNTI，RA-RNTI，SI-RNTI 和 $Q_m&gt; 2$ 调度的PDSCH。</p><h4 id="2-1-3-2-传输块大小确定"><a href="#2-1-3-2-传输块大小确定" class="headerlink" title="2.1.3.2 传输块大小确定"></a>2.1.3.2 传输块大小确定</h4><p>在高层参数 <em>maxNroCodeWordsScheduledByDCI</em> 指示启用两个码字传输的情况下，如果 $I_{MSC}=26，rv_{id}=1$，则DCI format 1_1 禁用传输块，否则传输块启用。如果两个传输块都被启用，则传输块1/2，分别映射到码字 0/1。如果仅启用一个传输块，则启用的传输块映射到第一个码字。</p></div><div><div><br><br><div style="text-align:center;color:#ccc;font-size:14px">----------- 本文结束 -----------</div><br><br><br><br></div></div><footer class="post-footer"><div class="post-tags"><a href="/tags/TS-38-214/" rel="tag"><i class="fa fa-tag">TS 38.214</i></a></div><div class="post-widgets"><div id="needsharebutton-postbottom"><span class="btn"><i class="fa fa-share-alt" aria-hidden="true"></i></span></div></div><div class="post-nav"><div class="post-nav-next post-nav-item"><a href="/5G_Protocol/5G-NR-213%E5%8D%8F%E8%AE%AE%E8%A1%A5%E5%85%85/" rel="next" title="5G-NR-213协议补充"><i class="fa fa-chevron-left"></i> 5G-NR-213协议补充</a></div><span class="post-nav-divider"></span><div class="post-nav-prev post-nav-item"><a href="/5G_Protocol/5G-NR-%E4%BC%A0%E8%BE%93%E6%B5%81%E7%A8%8B/" rel="prev" title="5G-NR-传输流程">5G-NR-传输流程 <i class="fa fa-chevron-right"></i></a></div></div></footer></div></article><div class="post-spread"></div></div></div></div><div class="sidebar-toggle"><div class="sidebar-toggle-line-wrap"><span class="sidebar-toggle-line sidebar-toggle-line-first"></span> <span class="sidebar-toggle-line sidebar-toggle-line-middle"></span> <span class="sidebar-toggle-line sidebar-toggle-line-last"></span></div></div><aside id="sidebar" class="sidebar"><div class="sidebar-inner"><ul class="sidebar-nav motion-element"><li class="sidebar-nav-toc sidebar-nav-active" data-target="post-toc-wrap">文章目录</li><li class="sidebar-nav-overview" data-target="site-overview-wrap">站点概览</li></ul><section class="site-overview-wrap sidebar-panel"><div class="site-overview"><div class="site-author motion-element" itemprop="author" itemscope itemtype="http://schema.org/Person"><a href="/"><img class="site-author-image" itemprop="image" src="/images/logo.jpg" alt="从之丶"></a><p class="site-author-name" itemprop="name">从之丶</p><p class="site-description motion-element" itemprop="description"></p></div><nav class="site-state motion-element"><div class="site-state-item site-state-posts"><a href="/archives/%7C%7C%20archive"><span class="site-state-item-count">38</span> <span class="site-state-item-name">日志</span></a></div><div class="site-state-item site-state-categories"><a href="/categories/index.html"><span class="site-state-item-count">6</span> <span class="site-state-item-name">分类</span></a></div><div class="site-state-item site-state-tags"><a href="/tags/index.html"><span class="site-state-item-count">33</span> <span class="site-state-item-name">标签</span></a></div></nav><div class="links-of-author motion-element"><span class="links-of-author-item"><a href="https://github.com/czGitAccount" target="_blank" title="GitHub"><i class="fa fa-fw fa-github"></i>GitHub</a> </span><span class="links-of-author-item"><a href="mailto:caoz326@163.com" target="_blank" title="E-Mail"><i class="fa fa-fw fa-envelope"></i>E-Mail</a></span></div><div class="links-of-blogroll motion-element links-of-blogroll-block"><div class="links-of-blogroll-title"><i class="fa fa-history fa-" aria-hidden="true"></i> 近期文章</div><ul class="links-of-blogroll-list"><li class="recent_posts_li"><a href="/Server_Programming/Linux%E9%AB%98%E6%80%A7%E8%83%BD%E6%9C%8D%E5%8A%A1%E5%99%A8%E7%BC%96%E7%A8%8Bexamples/" title="Linux 高性能服务器编程 examples" target="_blank">Linux 高性能服务器编程 examples</a></li><li class="recent_posts_li"><a href="/Data_Structure_and_Algorithm/%E8%83%8C%E5%8C%85%E9%97%AE%E9%A2%98/" title="背包问题" target="_blank">背包问题</a></li><li class="recent_posts_li"><a href="/Database/Skiplist-CPP/" title="基于跳表实现的键值型存储引擎" target="_blank">基于跳表实现的键值型存储引擎</a></li><li class="recent_posts_li"><a href="/Database/Redis/Redis%E6%95%B0%E6%8D%AE%E7%BB%93%E6%9E%84%E4%B8%8E%E5%AF%B9%E8%B1%A1/" title="Redis数据结构与对象" target="_blank">Redis数据结构与对象</a></li><li class="recent_posts_li"><a href="/C++_Language/STL/Algorithm/" title="STL_Algorithm" target="_blank">STL_Algorithm</a></li></ul></div></div></section><section class="post-toc-wrap motion-element sidebar-panel sidebar-panel-active"><div class="post-toc"><div class="post-toc-content"><ol class="nav"><li class="nav-item nav-level-1"><a class="nav-link" href="#上行传输模式"><span class="nav-text">上行传输模式</span></a><ol class="nav-child"><li class="nav-item nav-level-2"><a class="nav-link" href="#概述"><span class="nav-text">概述</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#基于码本传输"><span class="nav-text">基于码本传输</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#基于非码本传输"><span class="nav-text">基于非码本传输</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#PUSCH-信道预编码"><span class="nav-text">PUSCH 信道预编码</span></a></li></ol></li><li class="nav-item nav-level-1"><a class="nav-link" href="#TS-38-214协议补充"><span class="nav-text">TS 38.214协议补充</span></a><ol class="nav-child"><li class="nav-item nav-level-2"><a class="nav-link" href="#1-下行链路的功率分配"><span class="nav-text">1 下行链路的功率分配</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#2-物理下行链路共享信道相关流程"><span class="nav-text">2 物理下行链路共享信道相关流程</span></a><ol class="nav-child"><li class="nav-item nav-level-3"><a class="nav-link" href="#2-1-UE-用于接收物理下行链路共享信道的过程"><span class="nav-text">2.1 UE 用于接收物理下行链路共享信道的过程</span></a><ol class="nav-child"><li class="nav-item nav-level-4"><a class="nav-link" href="#2-1-1-传输方案"><span class="nav-text">2.1.1 传输方案</span></a></li></ol></li><li class="nav-item nav-level-3"><a class="nav-link" href="#2-1-2-资源分配"><span class="nav-text">2.1.2 资源分配</span></a><ol class="nav-child"><li class="nav-item nav-level-4"><a class="nav-link" href="#2-1-2-1-时域资源"><span class="nav-text">2.1.2.1 时域资源</span></a><ol class="nav-child"><li class="nav-item nav-level-5"><a class="nav-link" href="#2-1-2-1-1-确定用于PDSCH的资源分配表"><span class="nav-text">2.1.2.1.1 确定用于PDSCH的资源分配表</span></a></li></ol></li><li class="nav-item nav-level-4"><a class="nav-link" href="#5-1-2-2-频域资源分配"><span class="nav-text">5.1.2.2 频域资源分配</span></a><ol class="nav-child"><li class="nav-item nav-level-5"><a class="nav-link" href="#2-1-2-2-1-下行链路资源分配-Type-0-bitmap"><span class="nav-text">2.1.2.2.1 下行链路资源分配 Type 0 (bitmap)</span></a></li><li class="nav-item nav-level-5"><a class="nav-link" href="#2-1-2-2-2-下行链路资源分配-Type-1-RIV"><span class="nav-text">2.1.2.2.2 下行链路资源分配 Type 1 (RIV)</span></a></li></ol></li><li class="nav-item nav-level-4"><a class="nav-link" href="#2-1-2-3-PDSCH信道PRB-bundling"><span class="nav-text">2.1.2.3 PDSCH信道PRB bundling</span></a></li></ol></li><li class="nav-item nav-level-3"><a class="nav-link" href="#2-1-3-调制阶数，目标码率，冗余版本，传输块大小确定"><span class="nav-text">2.1.3 调制阶数，目标码率，冗余版本，传输块大小确定</span></a><ol class="nav-child"><li class="nav-item nav-level-4"><a class="nav-link" href="#2-1-3-1-调制阶数和目标码率确定"><span class="nav-text">2.1.3.1 调制阶数和目标码率确定</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#2-1-3-2-传输块大小确定"><span class="nav-text">2.1.3.2 传输块大小确定</span></a></li></ol></li></ol></li></ol></li></ol></div></div></section></div></aside></div></main><footer id="footer" class="footer"><div class="footer-inner"><div class="copyright">&copy; <span itemprop="copyrightYear">2021</span> <span class="with-love"><i class="fa fa-user"></i> </span><span class="author" itemprop="copyrightHolder">从之丶</span></div></div></footer><div class="back-to-top"><i class="fa fa-arrow-up"></i> <span id="scrollpercent"><span>0</span>%</span></div><div id="needsharebutton-float"><span class="btn"><i class="fa fa-share-alt" aria-hidden="true"></i></span></div></div><script type="text/javascript">"[object Function]"!==Object.prototype.toString.call(window.Promise)&&(window.Promise=null)</script><script type="text/javascript" src="/lib/jquery/index.js?v=2.1.3"></script><script type="text/javascript" src="/lib/fastclick/lib/fastclick.min.js?v=1.0.6"></script><script type="text/javascript" src="/lib/jquery_lazyload/jquery.lazyload.js?v=1.9.7"></script><script type="text/javascript" src="/lib/velocity/velocity.min.js?v=1.2.1"></script><script type="text/javascript" src="/lib/velocity/velocity.ui.min.js?v=1.2.1"></script><script type="text/javascript" src="/lib/fancybox/source/jquery.fancybox.pack.js?v=2.1.5"></script><script type="text/javascript" src="/lib/canvas-nest/canvas-nest.min.js"></script><i id="darkmode" class="fa fa-lightbulb-o" aria-hidden="true"></i><script>var body=$("body"),darkmode=$("#darkmode");(matchMedia("(prefers-color-scheme: dark)").matches||"1"===localStorage.getItem("darkmode"))&&"1"!==localStorage.getItem("noDark")&&body.addClass("dark"),body.hasClass("dark")?darkmode.removeClass("fa-moon-o").addClass("fa-lightbulb-o"):darkmode.removeClass("fa-lightbulb-o").addClass("fa-moon-o"),darkmode.click(function(){body.hasClass("dark")?(darkmode.removeClass("fa-lightbulb-o").addClass("fa-moon-o"),body.removeClass("dark"),localStorage.setItem("darkmode","0"),localStorage.setItem("noDark","1")):(darkmode.removeClass("fa-moon-o").addClass("fa-lightbulb-o"),body.addClass("dark"),localStorage.setItem("darkmode","1"),localStorage.setItem("noDark","0"))})</script><script type="text/javascript" src="/js/src/utils.js?v=5.1.4"></script><script type="text/javascript" src="/js/src/motion.js?v=5.1.4"></script><script type="text/javascript" src="/js/src/scrollspy.js?v=5.1.4"></script><script type="text/javascript" src="/js/src/post-details.js?v=5.1.4"></script><script type="text/javascript" src="/js/src/clipboard.min.js?v=5.1.4"></script><script type="text/javascript" src="/js/src/highlight-wrap.js?v=5.1.4"></script><script type="text/javascript" src="/js/src/bootstrap.js?v=5.1.4"></script><script type="text/javascript">function proceedsearch(){$("body").append('<div class="search-popup-overlay local-search-pop-overlay"></div>').css("overflow","hidden"),$(".search-popup-overlay").click(onPopupClose),$(".popup").toggle();var t=$("#local-search-input");t.attr("autocapitalize","none"),t.attr("autocorrect","off"),t.focus()}var isfetched=!1,isXml=!0,search_path="search.xml";0===search_path.length?search_path="search.xml":/json$/i.test(search_path)&&(isXml=!1);var path="/"+search_path,onPopupClose=function(t){$(".popup").hide(),$("#local-search-input").val(""),$(".search-result-list").remove(),$("#no-result").remove(),$(".local-search-pop-overlay").remove(),$("body").css("overflow","")},searchFunc=function(t,e,o){"use strict";$("body").append('<div class="search-popup-overlay local-search-pop-overlay"><div id="search-loading-icon"><i class="fa fa-spinner fa-pulse fa-5x fa-fw"></i></div></div>').css("overflow","hidden"),$("#search-loading-icon").css("margin","20% auto 0 auto").css("text-align","center"),$.ajax({url:t,dataType:isXml?"xml":"json",async:!0,success:function(t){isfetched=!0,$(".popup").detach().appendTo(".header-inner");var n=isXml?$("entry",t).map(function(){return{title:$("title",this).text(),content:$("content",this).text(),url:$("url",this).text()}}).get():t,r=document.getElementById(e),s=document.getElementById(o),a=function(){var t=r.value.trim().toLowerCase(),e=t.split(/[\s\-]+/);e.length>1&&e.push(t);var o=[];if(t.length>0&&n.forEach(function(n){function r(e,o,n,r){for(var s=r[r.length-1],a=s.position,i=s.word,l=[],h=0;a+i.length<=n&&0!=r.length;){i===t&&h++,l.push({position:a,length:i.length});var p=a+i.length;for(r.pop();0!=r.length&&(s=r[r.length-1],a=s.position,i=s.word,p>a);)r.pop()}return c+=h,{hits:l,start:o,end:n,searchTextCount:h}}function s(t,e){var o="",n=e.start;return e.hits.forEach(function(e){o+=t.substring(n,e.position);var r=e.position+e.length;o+='<b class="search-keyword">'+t.substring(e.position,r)+"</b>",n=r}),o+=t.substring(n,e.end)}var a=!1,i=0,c=0,l=n.title.trim(),h=l.toLowerCase(),p=n.content.trim().replace(/<[^>]+>/g,""),u=p.toLowerCase(),f=decodeURIComponent(n.url),d=[],g=[];if(""!=l&&(e.forEach(function(t){function e(t,e,o){var n=t.length;if(0===n)return[];var r=0,s=[],a=[];for(o||(e=e.toLowerCase(),t=t.toLowerCase());(s=e.indexOf(t,r))>-1;)a.push({position:s,word:t}),r=s+n;return a}d=d.concat(e(t,h,!1)),g=g.concat(e(t,u,!1))}),(d.length>0||g.length>0)&&(a=!0,i=d.length+g.length)),a){[d,g].forEach(function(t){t.sort(function(t,e){return e.position!==t.position?e.position-t.position:t.word.length-e.word.length})});var v=[];0!=d.length&&v.push(r(l,0,l.length,d));for(var $=[];0!=g.length;){var C=g[g.length-1],m=C.position,x=C.word,w=m-20,y=m+80;0>w&&(w=0),y<m+x.length&&(y=m+x.length),y>p.length&&(y=p.length),$.push(r(p,w,y,g))}$.sort(function(t,e){return t.searchTextCount!==e.searchTextCount?e.searchTextCount-t.searchTextCount:t.hits.length!==e.hits.length?e.hits.length-t.hits.length:t.start-e.start});var T=parseInt("1");T>=0&&($=$.slice(0,T));var b="";b+=0!=v.length?"<li><a href='"+f+"' class='search-result-title'>"+s(l,v[0])+"</a>":"<li><a href='"+f+"' class='search-result-title'>"+l+"</a>",$.forEach(function(t){b+="<a href='"+f+'\'><p class="search-result">'+s(p,t)+"...</p></a>"}),b+="</li>",o.push({item:b,searchTextCount:c,hitCount:i,id:o.length})}}),1===e.length&&""===e[0])s.innerHTML='<div id="no-result"><i class="fa fa-search fa-5x" /></div>';else if(0===o.length)s.innerHTML='<div id="no-result"><i class="fa fa-frown-o fa-5x" /></div>';else{o.sort(function(t,e){return t.searchTextCount!==e.searchTextCount?e.searchTextCount-t.searchTextCount:t.hitCount!==e.hitCount?e.hitCount-t.hitCount:e.id-t.id});var a='<ul class="search-result-list">';o.forEach(function(t){a+=t.item}),a+="</ul>",s.innerHTML=a}};r.addEventListener("input",a),$(".local-search-pop-overlay").remove(),$("body").css("overflow",""),proceedsearch()}})};$(".popup-trigger").click(function(t){t.stopPropagation(),isfetched===!1?searchFunc(path,"local-search-input","local-search-result"):proceedsearch()}),$(".popup-btn-close").click(onPopupClose),$(".popup").click(function(t){t.stopPropagation()}),$(document).on("keyup",function(t){var e=27===t.which&&$(".search-popup").is(":visible");e&&onPopupClose()})</script><link rel="stylesheet" href="/lib/needsharebutton/needsharebutton.css"><script src="/lib/needsharebutton/needsharebutton.js"></script><script>pbOptions={},pbOptions.iconStyle="box",pbOptions.boxForm="horizontal",pbOptions.position="bottomCenter",pbOptions.networks="Weibo,Wechat,Douban,QQZone,Twitter,Facebook",new needShareButton("#needsharebutton-postbottom",pbOptions),flOptions={},flOptions.iconStyle="box",flOptions.boxForm="horizontal",flOptions.position="middleRight",flOptions.networks="Weibo,Wechat,Douban,QQZone,Twitter,Facebook",new needShareButton("#needsharebutton-float",flOptions)</script><script type="text/x-mathjax-config">MathJax.Hub.Config({
        tex2jax: {
          inlineMath: [ ['$','$'], ["\\(","\\)"]  ],
          processEscapes: true,
          skipTags: ['script', 'noscript', 'style', 'textarea', 'pre', 'code']
        }
      });</script><script type="text/x-mathjax-config">MathJax.Hub.Queue(function() {
        var all = MathJax.Hub.getAllJax(), i;
        for (i=0; i < all.length; i += 1) {
          all[i].SourceElement().parentNode.className += ' has-jax';
        }
      });</script><script type="text/javascript" src="//cdn.bootcss.com/mathjax/2.7.1/latest.js?config=TeX-AMS-MML_HTMLorMML"></script><script src="/live2dw/lib/L2Dwidget.min.js?094cbace49a39548bed64abff5988b05"></script><script>L2Dwidget.init({pluginRootPath:"live2dw/",pluginJsPath:"lib/",pluginModelPath:"assets/",tagMode:!1,debug:!1,model:{jsonPath:"/live2dw/assets/wanko.model.json"},display:{position:"left",width:200,height:270},mobile:{show:!1},log:!1})</script></body></html><!-- rebuild by neat -->