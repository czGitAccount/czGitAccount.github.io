<!-- build time:Mon May 10 2021 14:07:39 GMT+0800 (GMT+08:00) --><!DOCTYPE html><html class="theme-next muse use-motion" lang="zh-Hans"><head><meta charset="UTF-8"><meta http-equiv="X-UA-Compatible" content="IE=edge"><meta name="viewport" content="width=device-width,initial-scale=1,maximum-scale=1"><meta name="theme-color" content="#222"><script src="/lib/pace/pace.min.js?v=1.0.2"></script><link href="/lib/pace/pace-theme-bounce.min.css?v=1.0.2" rel="stylesheet"><meta http-equiv="Cache-Control" content="no-transform"><meta http-equiv="Cache-Control" content="no-siteapp"><link href="/lib/fancybox/source/jquery.fancybox.css?v=2.1.5" rel="stylesheet" type="text/css"><link href="/lib/font-awesome/css/font-awesome.min.css?v=4.6.2" rel="stylesheet" type="text/css"><link href="/css/main.css?v=5.1.4" rel="stylesheet" type="text/css"><link rel="apple-touch-icon" sizes="180x180" href="/images/apple-touch-icon-next.png?v=5.1.4"><link rel="icon" type="image/png" sizes="32x32" href="/images/favicon.jpg?v=5.1.4"><link rel="icon" type="image/png" sizes="16x16" href="/images/favicon-16x16-next.png?v=5.1.4"><link rel="mask-icon" href="/images/logo.svg?v=5.1.4" color="#222"><meta name="keywords" content="PUSCH,"><meta property="og:type" content="article"><meta property="og:title" content="5G-NR-PUSCH学习"><meta property="og:url" content="https://czgitaccount.github.io/5G%E5%8D%8F%E8%AE%AE/5G-NR-PUSCH%E5%AD%A6%E4%B9%A0/index.html"><meta property="og:site_name" content="CongZ&#39;s Blog"><meta property="og:image" content="https://czgitaccount.github.io/5G%E5%8D%8F%E8%AE%AE/5G-NR-PUSCH%E5%AD%A6%E4%B9%A0/blog/source/_posts/5G%E5%8D%8F%E8%AE%AE/5G-NR-PUSCH%E5%AD%A6%E4%B9%A0/p1-base%20graph%E9%80%89%E6%8B%A9.png"><meta property="og:image" content="https://czgitaccount.github.io/5G%E5%8D%8F%E8%AE%AE/5G-NR-PUSCH%E5%AD%A6%E4%B9%A0/blog/source/_posts/5G%E5%8D%8F%E8%AE%AE/5G-NR-PUSCH%E5%AD%A6%E4%B9%A0/p2-%E7%A0%81%E5%9D%97%E5%88%86%E5%89%B2.png"><meta property="og:image" content="https://czgitaccount.github.io/5G%E5%8D%8F%E8%AE%AE/5G-NR-PUSCH%E5%AD%A6%E4%B9%A0/blog/source/_posts/5G%E5%8D%8F%E8%AE%AE/5G-NR-PUSCH%E5%AD%A6%E4%B9%A0/t3-38.212%205.3.2-1.png"><meta property="og:image" content="https://czgitaccount.github.io/5G%E5%8D%8F%E8%AE%AE/5G-NR-PUSCH%E5%AD%A6%E4%B9%A0/blog/source/_posts/5G%E5%8D%8F%E8%AE%AE/5G-NR-PUSCH%E5%AD%A6%E4%B9%A0/p3-%E7%BC%96%E7%A0%81%E7%9F%A9%E9%98%B5%E7%94%9F%E6%88%90.png"><meta property="og:image" content="https://czgitaccount.github.io/5G%E5%8D%8F%E8%AE%AE/5G-NR-PUSCH%E5%AD%A6%E4%B9%A0/blog/source/_posts/5G%E5%8D%8F%E8%AE%AE/5G-NR-PUSCH%E5%AD%A6%E4%B9%A0/p4-%E9%80%9F%E7%8E%87%E5%8C%B9%E9%85%8D.png"><meta property="og:image" content="https://czgitaccount.github.io/5G%E5%8D%8F%E8%AE%AE/5G-NR-PUSCH%E5%AD%A6%E4%B9%A0/blog/source/_posts/5G%E5%8D%8F%E8%AE%AE/5G-NR-PUSCH%E5%AD%A6%E4%B9%A0/p5-%E7%A0%81%E5%9D%97%E9%87%8D%E7%BB%84.png"><meta property="og:image" content="https://czgitaccount.github.io/5G%E5%8D%8F%E8%AE%AE/5G-NR-PUSCH%E5%AD%A6%E4%B9%A0/blog/source/_posts/5G%E5%8D%8F%E8%AE%AE/5G-NR-PUSCH%E5%AD%A6%E4%B9%A0/p6-VRB%E6%98%A0%E5%B0%841.png"><meta property="og:image" content="https://czgitaccount.github.io/5G%E5%8D%8F%E8%AE%AE/5G-NR-PUSCH%E5%AD%A6%E4%B9%A0/blog/source/_posts/5G%E5%8D%8F%E8%AE%AE/5G-NR-PUSCH%E5%AD%A6%E4%B9%A0/p7-VRB%E6%98%A0%E5%B0%842.png"><meta property="og:image" content="https://czgitaccount.github.io/5G%E5%8D%8F%E8%AE%AE/5G-NR-PUSCH%E5%AD%A6%E4%B9%A0/blog/source/_posts/5G%E5%8D%8F%E8%AE%AE/5G-NR-PUSCH%E5%AD%A6%E4%B9%A0/t2-38.214%206.1.2.1-1.png"><meta property="og:image" content="https://czgitaccount.github.io/5G%E5%8D%8F%E8%AE%AE/5G-NR-PUSCH%E5%AD%A6%E4%B9%A0/blog/source/_posts/5G%E5%8D%8F%E8%AE%AE/5G-NR-PUSCH%E5%AD%A6%E4%B9%A0/t9-211%206.4.1.1.3-3.png"><meta property="og:image" content="https://czgitaccount.github.io/5G%E5%8D%8F%E8%AE%AE/5G-NR-PUSCH%E5%AD%A6%E4%B9%A0/blog/source/_posts/5G%E5%8D%8F%E8%AE%AE/5G-NR-PUSCH%E5%AD%A6%E4%B9%A0/t12-211.png"><meta property="og:image" content="https://czgitaccount.github.io/5G%E5%8D%8F%E8%AE%AE/5G-NR-PUSCH%E5%AD%A6%E4%B9%A0/blog/source/_posts/5G%E5%8D%8F%E8%AE%AE/5G-NR-PUSCH%E5%AD%A6%E4%B9%A0/t10-211%206.4.1.1.3-4.png"><meta property="og:image" content="https://czgitaccount.github.io/5G%E5%8D%8F%E8%AE%AE/5G-NR-PUSCH%E5%AD%A6%E4%B9%A0/blog/source/_posts/5G%E5%8D%8F%E8%AE%AE/5G-NR-PUSCH%E5%AD%A6%E4%B9%A0/t13-211%206.4.1.1.3-6.png"><meta property="og:image" content="https://czgitaccount.github.io/5G%E5%8D%8F%E8%AE%AE/5G-NR-PUSCH%E5%AD%A6%E4%B9%A0/blog/source/_posts/5G%E5%8D%8F%E8%AE%AE/5G-NR-PUSCH%E5%AD%A6%E4%B9%A0/t7-211%206.4.1.1.3-1.png"><meta property="og:image" content="https://czgitaccount.github.io/5G%E5%8D%8F%E8%AE%AE/5G-NR-PUSCH%E5%AD%A6%E4%B9%A0/blog/source/_posts/5G%E5%8D%8F%E8%AE%AE/5G-NR-PUSCH%E5%AD%A6%E4%B9%A0/t8-211%206.4.1.1.3-2.png"><meta property="og:image" content="https://czgitaccount.github.io/5G%E5%8D%8F%E8%AE%AE/5G-NR-PUSCH%E5%AD%A6%E4%B9%A0/blog/source/_posts/5G%E5%8D%8F%E8%AE%AE/5G-NR-PUSCH%E5%AD%A6%E4%B9%A0/t14-211%206.4.1.1.3-5.png"><meta property="og:image" content="https://czgitaccount.github.io/5G%E5%8D%8F%E8%AE%AE/5G-NR-PUSCH%E5%AD%A6%E4%B9%A0/blog/source/_posts/5G%E5%8D%8F%E8%AE%AE/5G-NR-PUSCH%E5%AD%A6%E4%B9%A0/t4-211%206.4.1.2.1.2-1.png"><meta property="og:image" content="https://czgitaccount.github.io/5G%E5%8D%8F%E8%AE%AE/5G-NR-PUSCH%E5%AD%A6%E4%B9%A0/blog/source/_posts/5G%E5%8D%8F%E8%AE%AE/5G-NR-PUSCH%E5%AD%A6%E4%B9%A0/p8-PTRS1.png"><meta property="og:image" content="https://czgitaccount.github.io/5G%E5%8D%8F%E8%AE%AE/5G-NR-PUSCH%E5%AD%A6%E4%B9%A0/blog/source/_posts/5G%E5%8D%8F%E8%AE%AE/5G-NR-PUSCH%E5%AD%A6%E4%B9%A0/t5-211%206.4.1.2.2.1-1.png"><meta property="og:image" content="https://czgitaccount.github.io/5G%E5%8D%8F%E8%AE%AE/5G-NR-PUSCH%E5%AD%A6%E4%B9%A0/blog/source/_posts/5G%E5%8D%8F%E8%AE%AE/5G-NR-PUSCH%E5%AD%A6%E4%B9%A0/PTRS%E9%A2%91%E5%9F%9F%E5%9B%BE.png"><meta property="og:image" content="https://czgitaccount.github.io/5G%E5%8D%8F%E8%AE%AE/5G-NR-PUSCH%E5%AD%A6%E4%B9%A0/blog/source/_posts/5G%E5%8D%8F%E8%AE%AE/5G-NR-PUSCH%E5%AD%A6%E4%B9%A0/t6-211%206.4.1.2.2.2-1.png"><meta property="article:published_time" content="2020-04-09T12:13:06.000Z"><meta property="article:modified_time" content="2021-05-05T14:49:23.000Z"><meta property="article:author" content="从之丶"><meta property="article:tag" content="PUSCH"><meta name="twitter:card" content="summary"><meta name="twitter:image" content="https://czgitaccount.github.io/5G%E5%8D%8F%E8%AE%AE/5G-NR-PUSCH%E5%AD%A6%E4%B9%A0/blog/source/_posts/5G%E5%8D%8F%E8%AE%AE/5G-NR-PUSCH%E5%AD%A6%E4%B9%A0/p1-base%20graph%E9%80%89%E6%8B%A9.png"><script type="text/javascript" id="hexo.configurations">var NexT=window.NexT||{},CONFIG={root:"/",scheme:"Muse",version:"5.1.4",sidebar:{position:"left",display:"post",offset:12,b2t:!1,scrollpercent:"ture",onmobile:!1},fancybox:!0,tabs:!0,motion:{enable:!0,async:!1,transition:{post_block:"fadeIn",post_header:"slideDownIn",post_body:"slideDownIn",coll_header:"slideLeftIn",sidebar:"slideUpIn"}},duoshuo:{userId:"0",author:"博主"},algolia:{applicationID:"",apiKey:"",indexName:"",hits:{per_page:10},labels:{input_placeholder:"Search for Posts",hits_empty:"We didn't find any results for the search: ${query}",hits_stats:"${hits} results found in ${time} ms"}}}</script><link rel="canonical" href="https://czGitAccount.github.io/5G协议/5G-NR-PUSCH学习/"><title>5G-NR-PUSCH学习 | CongZ's Blog</title><meta name="generator" content="Hexo 4.2.0"></head><body itemscope itemtype="http://schema.org/WebPage" lang="zh-Hans"><div class="container sidebar-position-left page-post-detail"><div class="headband"></div><header id="header" class="header" itemscope itemtype="http://schema.org/WPHeader"><div class="header-inner"><div class="site-brand-wrapper"><div class="site-meta"><div class="custom-logo-site-title"><a href="/" class="brand" rel="start"><span class="logo-line-before"><i></i></span> <span class="site-title">CongZ's Blog</span> <span class="logo-line-after"><i></i></span></a></div><p class="site-subtitle">择其善者而从之，其不善者而改之 !</p></div><div class="site-nav-toggle"><button><span class="btn-bar"></span> <span class="btn-bar"></span> <span class="btn-bar"></span></button></div></div><nav class="site-nav"><ul id="menu" class="menu"><li class="menu-item menu-item-home"><a href="/" rel="section"><i class="menu-item-icon fa fa-fw fa-home"></i><br>首页</a></li><li class="menu-item menu-item-tags"><a href="/tags/" rel="section"><i class="menu-item-icon fa fa-fw fa-tags"></i><br>标签</a></li><li class="menu-item menu-item-categories"><a href="/categories/" rel="section"><i class="menu-item-icon fa fa-fw fa-th"></i><br>分类</a></li><li class="menu-item menu-item-archives"><a href="/archives/" rel="section"><i class="menu-item-icon fa fa-fw fa-archive"></i><br>归档</a></li><li class="menu-item menu-item-about"><a href="/about/" rel="section"><i class="menu-item-icon fa fa-fw fa-user"></i><br>关于</a></li><li class="menu-item menu-item-search"><a href="javascript:;" class="popup-trigger"><i class="menu-item-icon fa fa-search fa-fw"></i><br>搜索</a></li></ul><div class="site-search"><div class="popup search-popup local-search-popup"><div class="local-search-header clearfix"><span class="search-icon"><i class="fa fa-search"></i> </span><span class="popup-btn-close"><i class="fa fa-times-circle"></i></span><div class="local-search-input-wrapper"><input autocomplete="off" placeholder="搜索..." spellcheck="false" type="text" id="local-search-input"></div></div><div id="local-search-result"></div></div></div></nav></div></header><main id="main" class="main"><div class="main-inner"><div class="content-wrap"><div id="content" class="content"><div id="posts" class="posts-expand"><article class="post post-type-normal" itemscope itemtype="http://schema.org/Article"><div class="post-block"><link itemprop="mainEntityOfPage" href="https://czGitAccount.github.io/5G%E5%8D%8F%E8%AE%AE/5G-NR-PUSCH%E5%AD%A6%E4%B9%A0/"><span hidden itemprop="author" itemscope itemtype="http://schema.org/Person"><meta itemprop="name" content="从之丶"><meta itemprop="description" content=""><meta itemprop="image" content="/images/logo.jpg"></span><span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization"><meta itemprop="name" content="CongZ's Blog"></span><header class="post-header"><h1 class="post-title" itemprop="name headline">5G-NR-PUSCH学习</h1><div class="post-meta"><span class="post-time"><span class="post-meta-item-icon"><i class="fa fa-calendar-o"></i> </span><span class="post-meta-item-text">发表于</span> <time title="创建于" itemprop="dateCreated datePublished" datetime="2020-04-09T20:13:06+08:00">2020-04-09 </time></span><span class="post-category"><span class="post-meta-divider">|</span> <span class="post-meta-item-icon"><i class="fa fa-folder-o"></i> </span><span class="post-meta-item-text">分类于</span> <span itemprop="about" itemscope itemtype="http://schema.org/Thing"><a href="/categories/5G%E5%8D%8F%E8%AE%AE/" itemprop="url" rel="index"><span itemprop="name">5G协议</span></a></span></span><div class="post-wordcount"><span class="post-meta-item-icon"><i class="fa fa-file-word-o"></i> </span><span class="post-meta-item-text">字数统计&#58;</span> <span title="字数统计">5.6k </span><span class="post-meta-divider">|</span> <span class="post-meta-item-icon"><i class="fa fa-clock-o"></i> </span><span class="post-meta-item-text">阅读时长 &asymp;</span> <span title="阅读时长">26</span></div></div></header><div class="post-body" itemprop="articleBody"><div class="out-img-topic"><img src="/5G协议/5G-NR-PUSCH学习/弗洛伦萨.jpg" class="img-topic"></div><div class="post-button text-center"><div>弗洛伦萨	-- 意大利</div></div><a id="more"></a><h1 id="1-PUSCH信道处理流程"><a href="#1-PUSCH信道处理流程" class="headerlink" title="1 PUSCH信道处理流程"></a>1 PUSCH信道处理流程</h1><h2 id="1-1-TS-38-212对应处理过程"><a href="#1-1-TS-38-212对应处理过程" class="headerlink" title="1.1 TS 38.212对应处理过程"></a>1.1 TS 38.212对应处理过程</h2><h3 id="1-1-1-增加CRC校验"><a href="#1-1-1-增加CRC校验" class="headerlink" title="1.1.1 增加CRC校验"></a>1.1.1 增加CRC校验</h3><p>PUSCH数据$a_0,a_1,…,a_{A-1}$，首先判断传输块长度 A 的大小，来确定选择的 CRC方法：<br>$if$ $A &gt; 3824$<br>​ $g_{CRC24(D)}$ \\\ L = 24<br>$else$<br>​ $g_{CRC16(D)}$ \\\ L = 16</p><p>随后，$a_0,a_1,…,a_{A-1}$ 通过 $g_{CRC24(D)}$ 或 $g_{CRC16(D)}$ 来生成校验位 $p_0,p_1,…,p_{L-1}$</p><p>最后，将校验位$p_0,p_1,…,p_{L-1}$，附在 $a_0,a_1,…,a_{A-1}$ 后，形成添加CRC的数据，$a_0,…,a_{A-1},p_0,…,p_{L-1}$。即$b_0,b_1,…,b_{B-1}$，其中 $B = A+L$</p><h3 id="1-1-2-LDPC-base-graph-selection"><a href="#1-1-2-LDPC-base-graph-selection" class="headerlink" title="1.1.2 LDPC base graph selection"></a>1.1.2 LDPC base graph selection</h3><p>base graph 的选择有如下的规则：<br></p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">A ≤ 292 ——————————————————————→ LDPC base graph 2</span><br><span class="line">A ≤ 3824 and R ≤ 0.67 ————————→ LDPC base graph 2</span><br><span class="line">R ≤ 0.25 —————————————————————→ LDPC base graph 2</span><br><span class="line">else  ————————————————————————→ LDPC base graph 1</span><br></pre></td></tr></table></figure><br>即：<br><img src="/5G%E5%8D%8F%E8%AE%AE/5G-NR-PUSCH%E5%AD%A6%E4%B9%A0/blog/source/_posts/5G协议/5G-NR-PUSCH学习/p1-base graph选择.png" alt><p></p><p>可以近似理解为：<br>低码率/小TBS选择BG2；高码率/大TBS选择BG1。</p><h3 id="1-1-3-Code-block-码块分割和增加CRC"><a href="#1-1-3-Code-block-码块分割和增加CRC" class="headerlink" title="1.1.3 Code block 码块分割和增加CRC"></a>1.1.3 Code block 码块分割和增加CRC</h3><p>NR中LDPC编码，最大码块长度限定为：<br>LDPC base graph 1 $K_{cb} = 8448$ ;<br>LDPC base graph 2 $K_{cb} = 3840$;</p><p>因此TB块(含CRC)要根据LDPC码块长度分为多个码块。<br>待编码bit $b_0,b_1,…,b_{B-1}$</p><ul><li>当 $B\leq K_{cb}$， 码块个数 $C = 1$</li><li>当$B&gt; k_{cb}$，码块个数 $C = \lceil B/(K_{cb}-L)\rceil$，其中 $L = 24$ 为每个码块增加的CRC校验bit位数<br>如下图所示：</li></ul><p><img src="/5G%E5%8D%8F%E8%AE%AE/5G-NR-PUSCH%E5%AD%A6%E4%B9%A0/blog/source/_posts/5G协议/5G-NR-PUSCH学习/p2-码块分割.png" alt></p><p>以上每个码块内含有的比特数为 $K’ = B’/C$，即$B/C + L$，因为 $B’ = B + C\cdot L$</p><p>简单的说就是每个分组的的码块长度是 K’ 有三种情况：</p><ul><li>如果$B$ ≤ $K_{cb}$，$K’ = B$；</li><li>如果$B$ &gt; $K_{cb}$，除了最后一个可能取整多余出来分组外，$K’ = K_{cb}$;</li><li>就上述最后一个分组，$K’ = B - (C-1)\cdot(K_{cb}-L) + L$;</li></ul><p>码块长度确定后，要根据不同BG，生成编码矩阵，首先要确定编码矩阵的<strong>列数</strong>。</p><ul><li>对于BG1，$K_b = 22$，即基础矩阵的最大系统列数22列</li><li>对于BG2：<br>$if\quad B&gt;640\quad K_b = 10;$<br>$elseif\quad B&gt;560\quad K_b = 9;$<br>$elseif\quad B&gt;192\quad K_b = 8;$<br>$else\quad K_b = 6$</li></ul><p><strong>lifting size $Z_c$ </strong>：满足 $K_b\cdot Z_c \leq K’$，且是表格中的最小值。设，BG1：$K = 22Z_c$；BG2：$K = 10Z_c$。</p><p><img src="/5G%E5%8D%8F%E8%AE%AE/5G-NR-PUSCH%E5%AD%A6%E4%B9%A0/blog/source/_posts/5G协议/5G-NR-PUSCH学习/t3-38.212 5.3.2-1.png" alt></p><p>通过上图 $Z_c$ 所处在的集合，可以确定 Set Index ($i_{LS}$)。</p><h3 id="1-1-4-信道编码"><a href="#1-1-4-信道编码" class="headerlink" title="1.1.4 信道编码"></a>1.1.4 信道编码</h3><p>编码前，$c_0,c_1,c_2,…,c_{K-1}$，K由上文给出。<br>LDPC编码后，$d_0,d_1,d_2,…,d_{N-1}$，BG1：$N = 66Z_c$；BG2：$N = 50Z_c$。<br><strong>基矩阵</strong>：</p><ul><li>对于BG1：$H_{BG}$ 为 46$\times$68 的矩阵</li><li>对于BG2：$H_{BG}$ 为 42$\times$52 的矩阵</li></ul><p>$H_{BG}$ 中的元素通过 Set Index ($i_{LS}$) 查表获得：</p><blockquote><p>BG1：[TS 38.212 Table 5.3.2-2]<br>BG2：[TS 38.212 Table 5.3.2-3]</p></blockquote><p><strong>注</strong>：通过查表中的前两列可知 $H_{BG}$中对应的行列数元素值为1，其中没有的行列数对应的值为0，全部设置为0。表中 $V_{i,j}$ 则代表其奇偶校验矩阵对应的元素数值。</p><p>再利用Set Index ($i_{LS}$) 确定$V_{i,j}$后，根据$P_{i,j} = mod(V_{i,j},Z_c)$，获得编码矩阵的循环移位值，根据 $H_{BG}$ 生成编码校验矩阵 <strong>H</strong>，生成方式再协议中的描述如下：</p><p><img src="/5G%E5%8D%8F%E8%AE%AE/5G-NR-PUSCH%E5%AD%A6%E4%B9%A0/blog/source/_posts/5G协议/5G-NR-PUSCH学习/p3-编码矩阵生成.png" alt></p><p>简单来说就是将$H_{BG}$中的每个元素用大小为 $Z_c\times Z_c$ 的矩阵代替。</p><ul><li>如果元素值为0，则用大小为 $Z_c\times Z_c$ 的零矩阵代替。</li><li>如果元素值为1，则用大小为 $Z_c\times Z_c$ 的单位矩阵经过循环移位后的矩阵 $I(P_{i,j})$ 来替换。其中循环移位值由之前的$P_{i,j} = mod(V_{i,j},Z_c)$ 给出。</li></ul><p>总结，若：<br>待编码的信息比特，<strong>c</strong> $=[ c_0,c_1,c_2,…,c_{K-1}]^T$<br>其校验比特， <strong>w</strong> $=[w_0,w_1,…,w_{N+2Z_c-K-1}]^T$，可以得到 $H\times \left[ \begin{matrix} c\\w \end{matrix}\right]=0$</p><p><strong>疑问</strong>：用来生成<strong>[<em>c|W</em>]</strong>的生成矩阵到底是什么? 按理来说使用信息比特与生成矩阵相乘，产生信息比特和校验比特 <strong>[<em>c|W</em>]</strong>，这个生成矩阵到底是上面的那个<strong>$H_{BG}$</strong>又不是啊，<strong><em>H</em></strong>又是校验矩阵。</p><h3 id="1-1-5-速率匹配"><a href="#1-1-5-速率匹配" class="headerlink" title="1.1.5 速率匹配"></a>1.1.5 速率匹配</h3><p>完成LDPC编码后，得到 $d_0,d_1,d_2,…,d_{N-1}$。需要对其进行 Rate matching 速率适配，包括</p><ul><li>Bit selection</li><li>Bit interleaving</li></ul><p><img src="/5G%E5%8D%8F%E8%AE%AE/5G-NR-PUSCH%E5%AD%A6%E4%B9%A0/blog/source/_posts/5G协议/5G-NR-PUSCH学习/p4-速率匹配.png" alt></p><h3 id="1-1-6-码块串联"><a href="#1-1-6-码块串联" class="headerlink" title="1.1.6 码块串联"></a>1.1.6 码块串联</h3><p>将速率匹配完成后的数据码块按序重组。</p><p><img src="/5G%E5%8D%8F%E8%AE%AE/5G-NR-PUSCH%E5%AD%A6%E4%B9%A0/blog/source/_posts/5G协议/5G-NR-PUSCH学习/p5-码块重组.png" alt></p><h2 id="1-2-TS-38-211对应处理过程"><a href="#1-2-TS-38-211对应处理过程" class="headerlink" title="1.2 TS 38.211对应处理过程"></a>1.2 TS 38.211对应处理过程</h2><h3 id="1-2-1-加扰"><a href="#1-2-1-加扰" class="headerlink" title="1.2.1 加扰"></a>1.2.1 加扰</h3><p>对于单码字传输时，$q = 0$。[TS 38.211 7.3.1.1]，每一个码字对应的原始数据 $b^{(q)}(0),…,b^{(q)}(M_{bit}^{(q)}-1)$ ,经过加扰处理生成加扰后的数据为 $\widetilde b^{(q)}(0),…,\widetilde b^{(q)}(M_{bit}^{(q)}-1)$ 。加扰处理如下伪代码所示：</p><p>$while$ $i$ &lt; $M_{bit}^{(q)}$</p><p>​ $if$ $b^{(q)}(i) = x$ // UCI placeholder bits</p><p>​ $\widetilde b^{(q)}(i) = 1$</p><p>$else$<br>$if$ $b^{(q)}(i)=y$ // UCI placeholder bits</p><p>​ $\widetilde b^{(q)}(i) = \widetilde b^{(q)}(i-1)$</p><p>​ $else$</p><p>​ $\widetilde b^{(q)}(i) = (b^{(q)}(i) + c^{(q)}(i))mod2$</p><p>​ $end$ $if$</p><p>​ $end$ $if$</p><p>​ $i=i+1$</p><p>$end$ $ while$</p><p>其中加扰序列$c^{(q)}(i)$是一个伪随机序列，由[TS 38.211 5.2.1]给出，加扰序列的初始为：</p><script type="math/tex;mode=display">C_{init} = n_{RNTI}\cdot2^{15}+n_{ID}</script><p>其中</p><ul><li>$n_{RNTI}$ = C-RNTI or CS-RNTI , 并且在公共搜索空间中不使用DCI forrmat 0_0调度传输</li><li>$n_{ID}\in \{0,1,…,1023\}$ , 其值等于<em>dataScramblingIdentityPUSCH</em>(如果配置)，否则 $n_{ID} = N_{ID}^{cell}$</li></ul><h3 id="1-2-2-调制"><a href="#1-2-2-调制" class="headerlink" title="1.2.2 调制"></a>1.2.2 调制</h3><p>每一个码字加扰后的比特块 $\widetilde b^{(q)}(0),…,\widetilde b^{(q)}(M_{bit}^{(q)}-1)$ 采用下表中的一种调制方式进行调制，得到一个复值调制符号块$d^{(q)}(0),…,d^{(q)}(M_{symb}^{(q)}-1)$。[TS 38.211 6.3.1.2-1]</p><table><tr><th colspan="2"><center>Transform precoding disabled</center></th><th colspan="2"><center>Transform precoding enabled</center></th></tr><tr><td><center>Modulation scheme</center></td><td><center>Modulation order</center></td><td><center>Modulation scheme</center></td><td><center>Modulation order</center></td></tr><tr><td><center></center></td><td><center></center></td><td><center>π/2-BPSK</center></td><td><center>1</center></td></tr><tr><td><center>QPSK</center></td><td><center>2</center></td><td><center>QPSK</center></td><td><center>2</center></td></tr><tr><td><center>16QAM</center></td><td><center>4</center></td><td><center>16QAM</center></td><td><center>4</center></td></tr><tr><td><center>64QAM</center></td><td><center>6</center></td><td><center>64QAM</center></td><td><center>6</center></td></tr><tr><td><center>256QAM</center></td><td><center>8</center></td><td><center>256QAM</center></td><td><center>8</center></td></tr></table><h3 id="1-2-3-层映射"><a href="#1-2-3-层映射" class="headerlink" title="1.2.3 层映射"></a>1.2.3 层映射</h3><p>对于单个码字$q = 0$ , 每一个码字生成的调制信号 $d^{(q)}(0),…,d^{(q)}(M_{symb}^{(q)}-1)$ 根据表[TS 38.211 7.3.1.3-1] 映射到4层$x(i)=[x^0{i} \cdots x^{v-1}(i)]^T$，$i = 0,1,…,M_{symb}^{layer}-1$，具体的矩阵形式如下所示 , $M_{symb}^{layer}$ 表示每层调制符号的数量，其中$v$表示层数。,需要注意的是PUSCH最多映射4层，PDSCH最多8层。</p><script type="math/tex;mode=display">x(i)=[x^0{i} \cdots x^{v-1}(i)]^T\quad i = 0,1,...,M_{symb}^{layer}-1\\=\left[ \begin{matrix} x^{(0)}(0)&x^{(0)}(1)&\cdots&x^{(0)}(M_{sysmb}^{layer}-1)\\x^{(1)}(0)&x^{(1)}(1)&\cdots&x^{(1)}(M_{sysmb}^{layer}-1)\\ \vdots&\vdots&\ddots&\vdots \\x^{(p-1)}(0)&x^{(p-1)}(1)&\cdots&x^{(p-1)}(M_{sysmb}^{layer}-1)\end{matrix} \right]</script><div class="table-container"><table><thead><tr><th style="text-align:center">层数</th><th style="text-align:center">码字数</th><th>码字到层映射<br>$i = 0,1,…,M_{symb}^{layer}-1$</th></tr></thead><tbody><tr><td style="text-align:center">1</td><td style="text-align:center">1</td><td>$x^{(0)}(i) = d^{(0)}(i)$ $M_{symb}^{layer} = M_{symb}^{(0)}$</td></tr><tr><td style="text-align:center">2</td><td style="text-align:center">1</td><td>$x^{(0)}(i) = d^{(0)}(2i)$<br>$x^{(1)}(i) = d^{(0)}(2i+1)$ $M_{symb}^{layer} = M_{symb}^{(0)}/2$</td></tr><tr><td style="text-align:center">3</td><td style="text-align:center">1</td><td>$x^{(0)}(i) = d^{(0)}(3i)$<br>$x^{(1)}(i) = d^{(0)}(3i+1)$ $M_{symb}^{layer} = M_{symb}^{(0)}/3$<br>$x^{(2)}(i) = d^{(0)}(3i+2)$</td></tr><tr><td style="text-align:center">4</td><td style="text-align:center">1</td><td>$x^{(0)}(i) = d^{(0)}(4i)$<br>$x^{(1)}(i) = d^{(0)}(4i+1)$<br>$x^{(2)}(i) = d^{(0)}(4i+2)$ $M_{symb}^{layer} = M_{symb}^{(0)}/4$<br>$x^{(3)}(i) = d^{(0)}(4i+3)$</td></tr><tr><td style="text-align:center">5</td><td style="text-align:center">2</td><td>$x^{(0)}(i) = d^{(0)}(2i)$<br>$x^{(1)}(i) = d^{(0)}(2i+1)$<br>$x^{(2)}(i) = d^{(1)}(3i)$ $M_{symb}^{layer} = M_{symb}^{(0)}/2 = M_{symb}^{(1)}/3$<br>$x^{(3)}(i) = d^{(1)}(3i+1)$<br>$x^{(4)}(i) = d^{(1)}(3i+2)$</td></tr><tr><td style="text-align:center">6</td><td style="text-align:center">2</td><td>$x^{(0)}(i) = d^{(0)}(3i)$<br>$x^{(1)}(i) = d^{(0)}(3i+1)$<br>$x^{(2)}(i) = d^{(0)}(3i+2)$<br>$x^{(3)}(i) = d^{(1)}(3i)$ $M_{symb}^{layer} = M_{symb}^{(0)}/3 = M_{symb}^{(1)}/3$<br>$x^{(4)}(i) = d^{(1)}(3i+1)$<br>$x^{(5)}(i) = d^{(1)}(3i+2)$</td></tr><tr><td style="text-align:center">7</td><td style="text-align:center">2</td><td>$x^{(0)}(i) = d^{(0)}(3i)$<br>$x^{(1)}(i) = d^{(0)}(3i+1)$<br>$x^{(2)}(i) = d^{(0)}(3i+2)$<br>$x^{(3)}(i) = d^{(1)}(4i)$ $M_{symb}^{layer} = M_{symb}^{(0)}/3 = M_{symb}^{(1)}/4$<br>$x^{(4)}(i) = d^{(1)}(4i+1)$<br>$x^{(5)}(i) = d^{(1)}(4i+2)$<br>$x^{(6)}(i)=d^{(1)}(4i+3)$</td></tr><tr><td style="text-align:center">8</td><td style="text-align:center">2</td><td>$x^{(0)}(i) = d^{(0)}(4i)$<br>$x^{(1)}(i) = d^{(0)}(4i+1)$<br>$x^{(2)}(i) = d^{(0)}(4i+2)$<br>$x^{(3)}(i)=d^{(0)}(4i+3)$<br>$x^{(4)}(i) = d^{(1)}(4i)$ $M_{symb}^{layer} = M_{symb}^{(0)}/4 = M_{symb}^{(1)}/4$<br>$x^{(5)}(i) = d^{(1)}(4i+1)$<br>$x^{(6)}(i) = d^{(1)}(4i+2)$<br>$x^{(7)}(i)=d^{(1)}(4i+3)$</td></tr></tbody></table></div><h3 id="1-2-4-变换预编码"><a href="#1-2-4-变换预编码" class="headerlink" title="1.2.4 变换预编码"></a>1.2.4 变换预编码</h3><p>为了降低PAPR峰均比，上行PUSCH可以支持Transform Precoding , 即采用DFT-s-OFDM的形式，通过RRC层参数和DCI指示。</p><p>仅当<em>PUSCH-Config -&gt; transformprecoder</em> 配置 或者<em>RACH-configCommon -&gt; msg3-transformPrecoding</em> 配置时使用。</p><ul><li>如果变换预编码不可用，对于层$\lambda = 0,1,…,v-1$，有 $y^{(\lambda)}(i) = x^{(\lambda)}(i)$。</li><li>如果变换预编码可用，$v = 1$ , 且复值符号块$x^{(0)}(0),…,x^{(0)}(M_{symb}^{layer}-1)$ 被分为$M_{symb}^{layer}/M_{sc}^{PUSCH}$个集合，每个集合对应于一个OFDM符号。变换预编码根据如下公式进行：<script type="math/tex;mode=display">y^{(0)}(l \cdot M_{sc}^{PUSCH}+k)=\frac{1}{\sqrt{M_{sc}^{PUSCH}}}\sum_{i=0}^{M_{sc}^{PUSCH}-1}\widetilde x^{(0)}(l \cdot M_{sc}^{PUSCH}+i)e^{-j\frac{2\pi ik}{M_{sc}^{PUSCH}}}\\k =0,1,...,M_{sc}^{PUSCH}-1\\l=0,1,...,M_{symb}^{layer}/M_{sc}^{PUSCH}-1</script></li></ul><p>得到复值符号块 $y^{(0)}(0),…,y^{(0)}(M_{symb}^{layer}-1)$ 。$M_{sc}^{PUSCH} = M_{RB}^{PUSCH}\cdot M_{sc}^{RB}$，其中$M_{RB}^{PUSCH}$ 就是RB而言的带宽，并且满足</p><script type="math/tex;mode=display">M_{RB}^{PUSCH} = 2^{\alpha_2}\cdot 3^{\alpha_3}\cdot 5^{\alpha_5}\leq N_{RB}^{UL}</script><p>其中 $\alpha_2,\alpha_3,\alpha_5$ 是非负整数集合。</p><h3 id="1-2-5-预编码"><a href="#1-2-5-预编码" class="headerlink" title="1.2.5 预编码"></a>1.2.5 预编码</h3><p>根据如下公式对向量块$[y^{(0)}(i),…,y^{(v-1)}(i)]^{T},i = 0,1,…,M_{symb}^{layer}-1$ 进行预编码处理：</p><script type="math/tex;mode=display">\left[\begin{matrix} z^{(0)}(i)\\ \vdots\\ z^{(p-1)}(i) \end{matrix} \right]=W\left[\begin{matrix} y^{(0)}(i)\\ \vdots \\ y^{(p-1)}(i) \end{matrix} \right]</script><p>其中 $i = 0,1,…,M_{symb}^{ap} -1, M_{symb}^{ap} =M_{symb}^{layer}$ 。</p><p>RRC 参数如下：<br></p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">txConfig				ENUMERATED &#123;codebook,nonCodebook&#125;</span><br></pre></td></tr></table></figure><p></p><p>对于基于非码本的传输，预编码矩阵 <strong>W</strong> 为单位矩阵。<br>对于基于码本的传输，预编码矩阵 <strong>W</strong>：</p><ul><li><p>When number of layer = 1, number of antenna port = 1，<strong>W</strong> = 1。</p></li><li><p>When number of layer $\geq$ 1 and number of antenna port $\geq$ 2 ，</p><p>根据DCI 0-1中的 “Precoding information and number of layers” 确定预编码矩阵<strong>W</strong>(参考如下表格)：</p><blockquote><p>[TS 38.211 Table 6.3.1.5-1]<br>[TS 38.211 Table 6.3.1.5-2]<br>[TS 38.211 Table 6.3.1.5-3]<br>[TS 38.211 Table 6.3.1.5-4]<br>[TS 38.211 Table 6.3.1.5-5]<br>[TS 38.211 Table 6.3.1.5-6]<br>[TS 38.211 Table 6.3.1.5-7]</p></blockquote></li></ul><p>按照层数，天线端口数，是否配置变换预编码，三者的参数，选取预编码矩阵，总结成如下表格：</p><div class="table-container"><table><thead><tr><th>Number of Layers</th><th>Number of Antenna</th><th>Transform Precoding</th><th>Precoding Matrix</th></tr></thead><tbody><tr><td>1</td><td>2</td><td></td><td>211 Table 6.3.1.5-1</td></tr><tr><td>1</td><td>4</td><td>enabled</td><td>211 Table 6.3.1.5-2</td></tr><tr><td>1</td><td>4</td><td>disabled</td><td>211 Table 6.3.1.5-3</td></tr><tr><td>2</td><td>2</td><td>disabled</td><td>211 Table 6.3.1.5-4</td></tr><tr><td>2</td><td>4</td><td>disabled</td><td>211 Table 6.3.1.5-5</td></tr><tr><td>3</td><td>4</td><td>disabled</td><td>211 Table 6.3.1.5-6</td></tr><tr><td>4</td><td>4</td><td>disabled</td><td>211 Table 6.3.1.5-7</td></tr></tbody></table></div><h3 id="1-2-6-映射到VRB"><a href="#1-2-6-映射到VRB" class="headerlink" title="1.2.6 映射到VRB"></a>1.2.6 映射到VRB</h3><p>对于用于传输PUSCH的每个天线端口，复值符号块 $z^{(p)}(0),…,z^{(p)}(M_{symb}^{ap}-1)$ 应与幅度缩放因子$\beta_{PUSCH}$相乘，以满足[5,TS 38.213]中规定的发射功率。<br>对于每个天线步骤，都会创建一个虚拟资源网格。在资源网格内，从RE的最低频率到较高频率的来自来填充PUSCH数据到每个RE中。一旦它以分配的PUSCH资源块的最高频率到达RE，则移至下一个OFDM符号的最低频率的RE。</p><h3 id="1-2-7-映射到PRB"><a href="#1-2-7-映射到PRB" class="headerlink" title="1.2.7 映射到PRB"></a>1.2.7 映射到PRB</h3><p>按照之前的协议：有交织和非交织两种模式，和PDSCH一样。参考PDSCH映射规则。<br>按照现在<strong>最新版本</strong>的协议，只有<strong>非交织</strong>的模式。如下所示：</p><p><img src="/5G%E5%8D%8F%E8%AE%AE/5G-NR-PUSCH%E5%AD%A6%E4%B9%A0/blog/source/_posts/5G协议/5G-NR-PUSCH学习/p6-VRB映射1.png" alt><br><img src="/5G%E5%8D%8F%E8%AE%AE/5G-NR-PUSCH%E5%AD%A6%E4%B9%A0/blog/source/_posts/5G协议/5G-NR-PUSCH学习/p7-VRB映射2.png" alt></p><h1 id="2-PUSCH-DMRS"><a href="#2-PUSCH-DMRS" class="headerlink" title="2 PUSCH DMRS"></a>2 PUSCH DMRS</h1><h2 id="2-1-序列生成"><a href="#2-1-序列生成" class="headerlink" title="2.1 序列生成"></a>2.1 序列生成</h2><p>有两种条件下DMRS序列生成方式，Transform Precoding disabled，Transform Precoding enabled。</p><h3 id="2-1-1-Transform-Precoding-disabled"><a href="#2-1-1-Transform-Precoding-disabled" class="headerlink" title="2.1.1 Transform Precoding disabled"></a>2.1.1 Transform Precoding disabled</h3><p>这种情况的生成方式是与PDSCH DMRS一样的：<br>PUSCH DMRS序列有如下公式生成：</p><script type="math/tex;mode=display">r(n) = \frac{1}{\sqrt{2}}(1-2\cdot c(2n))+j\frac{1}{\sqrt{2}}(1-2\cdot c(2n+1))</script><p>加扰序列采用31阶Gold序列生成，加扰序列的初始序列$c_{init}$如下式所示:</p><script type="math/tex;mode=display">c_{init} = (2^{17}(N_{symb}^{slot}n_{s,f}^{\mu}+l+1)(2N_{ID}^{\overline n_{SCID}^{\overline \lambda}}+1)+2^{17}\lfloor\frac{\overline \lambda}{2} \rfloor+2N_{ID}^{\overline n_{SCID}^{\overline \lambda}}+\overline n_{SCID}^{\overline \lambda})mod2^{31}</script><p>其中： $l$ 为时隙中的符号索引， $n_{s,f}$ 为时隙索引， $N_{symb}^{slot}$ 为一个时隙内的符号数量。</p><ul><li>$N_{ID}^0,N_{ID}^1\in\{0,1,…,65535\}$：分别由高层参数 <em>scramblingID0</em> 和 <em>scramblingID1</em> 给出 （如果配置的话，且PUSCH由 DCI format 0_1,0_2调度，或者是具有配置的授权的PUSCH传输）；</li><li>$N_{ID}^0\in\{0,1,…,65535\}$：由 <em>DMRS-UplinkConfig -&gt; scramblingID0</em> 给出（如果配置的话，且PUSCH由被 C-RNTI，MSC-C-RNTI，或者 CS－RNTI 加扰的 DCI format 0_0 调度）；</li><li>$N_{ID}^0,N_{ID}^1\in\{0,1,…,65535\}$：对于每个msgA PUSCH 配置，分别由高层参数 <em>msgA-DMRS-Configuration</em> -&gt; <em>msgA-scramblingID0</em> , <em>msgA-scramblingID1</em>给出（如果配置的话，且PUSCH传输是由Type-2随机接入过程触发的）；</li><li>$N_{ID}^{\overline n_{SCID}^{\overline \lambda}}=N_{ID}^{cell}$ otherwise；</li><li>$\overline n_{SCID}^{\overline \lambda}$ and $\overline \lambda$ 由高层参数 <em>DMRS-UplinkConfig -&gt; dmrs-Uplink-r16</em>给出，其中 $\lambda$ 是CDM group：<script type="math/tex;mode=display">N_{ID}^{\overline n_{SCID}^{\overline \lambda}}=\begin{cases}n_{SCID}\quad\quad\quad \lambda=0\quad or\quad\lambda = 2\\1-n_{SCID}\quad\quad \lambda=1 \end{cases}\\\overline \lambda = \lambda</script>否则<script type="math/tex;mode=display">N_{ID}^{\overline n_{SCID}^{\overline \lambda}}=n_{SCID}\\ \overline \lambda = 0</script>其中 $n_{SCID}\in \{0,1\}$：</li><li>如果使用DCI format 0_1 或者 0_2，则在与PUSCH传输相关的DCI中使用 DM-RS初始化字段（如果存在）</li><li>由高层参数 <em>dmrs-SeqInitialization</em> 给出（如果存在，且是具有配置的授权的Type 1 PUSCH传输，或者PUSCH传输是由Type-2随机接入过程触发的）；</li><li>否则 $n_{SCID} = 0$；</li></ul><h3 id="2-1-2-Transform-Precoding-enabled"><a href="#2-1-2-Transform-Precoding-enabled" class="headerlink" title="2.1.2 Transform Precoding enabled"></a>2.1.2 Transform Precoding enabled</h3><p>生成公式如下：</p><script type="math/tex;mode=display">r(n)=r_{u,v}^{(\alpha,\delta)}(n)\\n=0,1,...,M_{sc}^{PUSCH}/2^{\delta}-1</script><p>其中 $r_{u,v}^{(\alpha,\delta)}(n)$ 中 $\delta = 1,\alpha =0$</p><ul><li>如果高层参数 <em>dmrsUplinkTransformPrecoding-r16</em> 已配置，PUSCH使用 $\pi/3-BPSK$ 调制 ，且此次PUSCH传输不是 msg3，并且这次传输在CCS中并没有使用 DCI format 0_0 调度，$r_{u,v}^{(\alpha,\delta)}(n)$ 为低均峰比序列，见[TS 38.211 5.2.2~3]。</li></ul><p>序列组 $u = (f_{gh}+n_{ID}^{RS})mod30$，其中$n_{ID}^{RS}$由下面给出：</p><ul><li><p>$n_{ID}^{RS}=n_{ID}^{PUSCH}$，如果 $n_{ID}^{PUSCH}$ 由高层参数<em>DMRS-UplinkConfig</em> -&gt; <em>nPUSCH-Identity</em> 配置，而高层参数<em>dmrsUplinkTransformPrecoding-r16</em> 为配置，而且PUSCH既不是由RAR UL调度，也不是由利用TC-RNTI加扰的DCI format 0_0 调度的；</p></li><li><p>$n_{ID}^{RS}=n_{ID}^{PUSCH}$，如果 $n_{ID}^{PUSCH}$ 由高层参数<em>dmrs-UplinkTransformPrecoding-r16</em>配置，PUSCH 使用 $\pi/2-BPSK$ 调制，且此次PUSCH传输不是 msg3，并且这次传输在 CCS中并没有使用 DCI format 0_0 调度。</p></li><li>$n_{ID}^{RS} = N_{ID}^{cell}$ otherwise；</li></ul><p>其中 $f_{gh}$ 和 序列数 $v$ 由下面给出：</p><ul><li>如果既没有组跳变也没有序列跳变<script type="math/tex;mode=display">f_{gh}=0\\v-0</script></li><li>如果配置了组跳变，未配置序列跳变<script type="math/tex;mode=display">f_{gh} = (\sum_{m = 0}^{7}2^mc(8(N_{symb}^{slot}n_{s,f}^{\mu}+l)+m))mod30\\v=0\\c_{init}=\lfloor n_{ID}^{RS}/30 \rfloor</script></li><li>如果序列跳变配置，组跳变未配置<script type="math/tex;mode=display">f_{gs} = 0\\v=\begin{cases}v = c(N_{symb}^{slot}n_{s,f}^{\mu}+l) \quad if\quad M_{ZC}\geq 6N_{sc}^{RB}\\0\quad\quad\quad\quad\quad\quad\quad\quad\quad otherwise \end{cases}\\c_{init}=n_{ID}^{RS}</script></li></ul><p>跳变模式(hopping mode)由高层参数控制：</p><ul><li>如果PUSCH传输是由RAR UL 调度的，或者是由由TC-RNTI 加扰的 DCI format 0_0 调度的，此时序列跳变禁用，组跳变禁用启用于否由高层参数 <em>groupHoppingEnabledTransformPrecoding</em> 决定；</li><li>其他传输时，序列跳变和组跳变的禁用启用与否分别由高层参数 <em>sequenceHopping , sequenceGroupHopping</em> 决定（如果这些参数配置的话，否则将采用和Msg3一样的hopping mode）。</li></ul><p>UE 是并不期待同时处理序列跳变和组跳变的。</p><h2 id="2-2-资源映射"><a href="#2-2-资源映射" class="headerlink" title="2.2 资源映射"></a>2.2 资源映射</h2><p>序列 $r(m)$ 被 映射中间值为 $\widetilde \alpha_{k,l}^{(\widetilde p_j,\mu)}$ ，根据如下：</p><ul><li>①if transform precoding is not enable,<script type="math/tex;mode=display">\widetilde \alpha_{k,l}^{(\widetilde p_j,\mu)}=w_f(k')w_t(l')r(2n+k')\\k = \begin{cases}4n+2k'+\Delta \quad \quad Configuration\quad type\quad1\\6n+k'+\Delta\quad \quad Configuration\quad type\quad 2 \end{cases}\\k'=0,1\\l=\overline{l}+l'\\n = 0,1,...\\j=0,1,...,v-1</script></li><li>②if transform precoding is enable<script type="math/tex;mode=display">\widetilde \alpha_{k,l}^{(\widetilde p_j,\mu)}=w_f(k')w_t(l')r(2n+k')\\k=4n+2k'+\Delta\\k'=0,1\\l=\overline l+l'\\n=0,1,...</script>中间值 $\widetilde \alpha_{k,l}^{(\widetilde p_j,\mu)}$ 会经过预编码矩阵 <strong><em>W</em></strong> 和缩放因子 $\beta_{PUSCH}^{DMRS}$ , 最终映射为 $\alpha_{k,l}^{( p_j,\mu)}$，如下所示：<script type="math/tex;mode=display">\left[ \begin{matrix}\alpha_{k,l}^{( p_0,\mu)}\\ \vdots\\\alpha_{k,l}^{( p_{\rho-1},\mu)}  \end{matrix}\right]=\beta_{PUSCH}^{DMRS}W\left[ \begin{matrix}\widetilde \alpha_{k,l}^{( \widetilde p_0,\mu)}\\ \vdots\\ \widetilde \alpha_{k,l}^{(\widetilde p_{\rho-1},\mu)} \end{matrix} \right]</script></li></ul><h3 id="2-2-1-频域索引"><a href="#2-2-1-频域索引" class="headerlink" title="2.2.1 频域索引"></a>2.2.1 频域索引</h3><p>由以上可知</p><ul><li>① 情形时，DMRS的映射情况和PUSCH DMRS 一致</li><li>② 情形时，其频域映射规则只有Configuration Type 1</li></ul><p>需要注意的是，对于两种情况的参考点</p><ul><li>①情形时，其参考点是PUSCH RB#0</li><li>②情形时，其参考点是CRB#0</li></ul><h3 id="2-2-2-时域索引"><a href="#2-2-2-时域索引" class="headerlink" title="2.2.2 时域索引"></a>2.2.2 时域索引</h3><p>DMRS的符号位置取决于PDSCH的mapping type，分为mapping type A 和 mapping type B，如下表所示：</p><p><img src="/5G%E5%8D%8F%E8%AE%AE/5G-NR-PUSCH%E5%AD%A6%E4%B9%A0/blog/source/_posts/5G协议/5G-NR-PUSCH学习/t2-38.214 6.1.2.1-1.png" alt></p><p>PUSCH 与 PDSCH 的差别除了初始符号位置和符号长度的些许区别外，还在于PUSCH 还会配置 <em>frequency intra-slot hopping</em> 方式，是否hopping 的两种方式下DMRS符号会有些差异。所以DMRS也会略有不同。<br>但是PUSCH和PDSC和的DMRS类似，PUSCH DMRS也支持：</p><ul><li><em>Front-loaded DM-RS</em>：支持单前置，双前置</li><li><em>Additional DM-RS</em>：支持单符号和双符号</li></ul><p>两种hopping下的DMRS：</p><ul><li>对于不跳频：其时域映射和PDSCH DMRS 机制一样，参考表[TS 38.211 6.4.1.1.3-3~4]</li></ul><p><img src="/5G%E5%8D%8F%E8%AE%AE/5G-NR-PUSCH%E5%AD%A6%E4%B9%A0/blog/source/_posts/5G协议/5G-NR-PUSCH学习/t9-211 6.4.1.1.3-3.png" alt></p><p><img src="/5G%E5%8D%8F%E8%AE%AE/5G-NR-PUSCH%E5%AD%A6%E4%B9%A0/blog/source/_posts/5G协议/5G-NR-PUSCH学习/t12-211.png" alt><br><img src="/5G%E5%8D%8F%E8%AE%AE/5G-NR-PUSCH%E5%AD%A6%E4%B9%A0/blog/source/_posts/5G协议/5G-NR-PUSCH学习/t10-211 6.4.1.1.3-4.png" alt></p><ul><li>对于跳频：其时域映射,参考表[TS 38.211 6.4.1.1.3-6],注意此时<strong>仅支持</strong>单前置+additional DMRS。</li></ul><p><img src="/5G%E5%8D%8F%E8%AE%AE/5G-NR-PUSCH%E5%AD%A6%E4%B9%A0/blog/source/_posts/5G协议/5G-NR-PUSCH学习/t13-211 6.4.1.1.3-6.png" alt></p><h2 id="2-3-天线端口问题"><a href="#2-3-天线端口问题" class="headerlink" title="2.3 天线端口问题"></a>2.3 天线端口问题</h2><p>PUSCH DMRS Type 1 和 Type 2 多天线端口CDM group 定义和PDSCH DMRS相同，仅仅是天线端口的编号差异。参考表格[TS 38.211 6.1.1.3-1,2,5]如下：</p><p><img src="/5G%E5%8D%8F%E8%AE%AE/5G-NR-PUSCH%E5%AD%A6%E4%B9%A0/blog/source/_posts/5G协议/5G-NR-PUSCH学习/t7-211 6.4.1.1.3-1.png" alt></p><p><img src="/5G%E5%8D%8F%E8%AE%AE/5G-NR-PUSCH%E5%AD%A6%E4%B9%A0/blog/source/_posts/5G协议/5G-NR-PUSCH学习/t8-211 6.4.1.1.3-2.png" alt></p><p><img src="/5G%E5%8D%8F%E8%AE%AE/5G-NR-PUSCH%E5%AD%A6%E4%B9%A0/blog/source/_posts/5G协议/5G-NR-PUSCH学习/t14-211 6.4.1.1.3-5.png" alt></p><ul><li>type 1，single symbol情况下，最多支持4个端口，端口0，1和2，3分别在不同的CDM group，每个CDM group内，比如端口0和1，又通过频域的OCC来实现正交，从而实现4个端口的正交。</li><li>type 1，double symbol情况下，最多支持8个端口，除了频域OCC外，还可以时域OCC来实现正交，所以可以支持更多的端口。</li><li>type 2，single symbol情况下，最多支持6个端口，共三个CDM group，每个group内又通过频域OCC实现正交。</li><li>type 2，double symbol情况下，最多支持12个端口，与类型1双符号情况同理，除了频域OCC外，还可以时域OCC，从而支持更多的端口。</li></ul><h1 id="3-PUSCH-PTRS"><a href="#3-PUSCH-PTRS" class="headerlink" title="3 PUSCH PTRS"></a>3 PUSCH PTRS</h1><h2 id="3-1-序列生成"><a href="#3-1-序列生成" class="headerlink" title="3.1 序列生成"></a>3.1 序列生成</h2><p>有两种条件下PTRS序列生成方式，Transform Precoding disabled，Transform Precoding enabled。</p><h3 id="3-1-1-Transform-Precoding-disabled"><a href="#3-1-1-Transform-Precoding-disabled" class="headerlink" title="3.1.1 Transform Precoding disabled"></a>3.1.1 Transform Precoding disabled</h3><p>如果未使用变换预编码，层j上子载波k上的PTRS由下式给出：</p><script type="math/tex;mode=display">r^{(\widetilde p_j)}(m) = \begin{cases}r(m)\quad\quad if\quad j=j'||j =  j''\\0\quad\quad\quad\quad otherwise \end{cases}</script><ul><li>序列$r(m)$与对应的PUSCH的DMRS相同</li><li>不论是否跳频，PTRS的时域位置都在所在子载波的第一个DMRS符号上。</li><li><h3 id="3-1-2-Transform-Precoding-enabled"><a href="#3-1-2-Transform-Precoding-enabled" class="headerlink" title="3.1.2 Transform Precoding enabled"></a>3.1.2 Transform Precoding enabled</h3>如果未使用变换预编码，PTRS再DFT之前插入，此时PTRS映射位置m取决于PTRS group数量和每个group内sample的数量以及PUSCH总共所占的子载波的数量。序列生成公式如下所示：<script type="math/tex;mode=display">r_{m}(m')=w(k')\frac{e^{j\frac{\pi}{2}(mmod2)}}{\sqrt{2}}[(1-2c(m'))+j(1-2c(m'))]\\m'=N_{samp}^{group}s'+k'\\s'=0,1,...N_{group}^{PT-RS}-1\\k' = 0,1,N_{samp}^{group}-1\\c_{init}=(2^{17}(N_{symb}^{slot}n_{s,f}^{\mu}+l+1)(2N_{ID}+1)+2N_{ID})mod2^{31}</script>$w(i)$ 由下表给出：</li></ul><p><img src="/5G%E5%8D%8F%E8%AE%AE/5G-NR-PUSCH%E5%AD%A6%E4%B9%A0/blog/source/_posts/5G协议/5G-NR-PUSCH学习/t4-211 6.4.1.2.1.2-1.png" alt></p><h2 id="3-2-资源映射"><a href="#3-2-资源映射" class="headerlink" title="3.2 资源映射"></a>3.2 资源映射</h2><p>同样对应着有两种条件下PTRS序列映射方式，Transform Precoding disabled，Transform Precoding enabled。</p><h3 id="3-2-1-Transform-Precoding-disabled"><a href="#3-2-1-Transform-Precoding-disabled" class="headerlink" title="3.2.1 Transform Precoding disabled"></a>3.2.1 Transform Precoding disabled</h3><p>UE只在高层信令指示PTRS传输下才传输，且只在PUSCH内传输PTRS，映射到RE的公式如下</p><script type="math/tex;mode=display">\left[ \begin{matrix}a_{k.l}^{(p_0,\mu)}\\ \vdots\\ a_{k.l}^{(p_{\rho-1},\mu)} \end{matrix} \right]=\beta_{PT-RS}W\left[ \begin{matrix}r^{(\widetilde p_0)}(2n+k')\\ \vdots\\ r^{(\widetilde p_v-1{})}(2n+k') \end{matrix} \right]\\k=\begin{cases}4n+2k'+\Delta\quad\quad configuration\quad type1\\6n+k'+\Delta\quad\quad\quad configuration\quad type2 \end{cases}</script><p>其中：</p><ul><li>$l$ 是PUSCH所占OFDM符号数；</li><li>RE未被DMRS占用；</li><li>$k’$ and $\Delta$ 对应 $\widetilde p_0,…,\widetilde p_{v-1}$</li><li>W是预编码矩阵</li><li>$\beta_{PT-RS}$ 是功率因子</li></ul><h4 id="3-2-1-1-时域索引"><a href="#3-2-1-1-时域索引" class="headerlink" title="3.2.1.1 时域索引"></a>3.2.1.1 时域索引</h4><p>确定时域索引$l$的方式如下：<br></p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line">1. set i&#x3D;0 and l_&#123;ref&#125; &#x3D; 0 </span><br><span class="line">2. if any symbol in the interval max(l_&#123;ref&#125;+(i-1)L_&#123;PT-RS&#125; + 1,l_&#123;ref&#125;),…,l_&#123;ref&#125; + iL_&#123;PT-RS&#125; overlaps with a symbol used for DM-RS according to clause 6.4.1.1.3</span><br><span class="line">-	set i&#x3D;1</span><br><span class="line">-	set l_&#123;ref&#125; to the symbol index of the DM-RS symbol in case of a single-symbol DM-RS or to the symbol index of the second DM-RS symbol in case of a double-symbol DM-RS</span><br><span class="line">-	repeat from step 2 as long as l_&#123;ref&#125; +iL_&#123;PT-RS&#125; is inside the PUSCH allocation</span><br><span class="line">3. add l_&#123;ref&#125; + iL_&#123;PT-RS&#125; to the set of time indices for PT-RS</span><br><span class="line">4. increment i by one</span><br><span class="line">5. repeat from step 2 above as long as l_&#123;ref&#125; +iL_&#123;PT-RS&#125; is inside the PUSCH allocation</span><br><span class="line">where L_&#123;PT-RS&#125;∈&#123;1，2，4&#125; is defined in Table 6.2.3.1-1 of [6,TS 38.214].</span><br></pre></td></tr></table></figure><br>以上步骤简单描述如下：<br>$L_{PT-RS}$ 表示PTRS再时域上的密度，也就是每 $L_{PT-RS}$ 个符号有一个PTRS符号。配置方式为：从PUSCH开始调度的位置开始，直到PUSCH结束，每个L符号配置PTRS，如果碰到了DMRS，则重新开始计数。例如，PUSCH在一个slot内调度，即从$i = 0$ 开始，$i = 13$ 结束，$L_{PT-RS} = 4$，DMRS在 $l = 2$ 的符号上，则PTRS时域配置情形如下图所示：<p></p><p><img src="/5G%E5%8D%8F%E8%AE%AE/5G-NR-PUSCH%E5%AD%A6%E4%B9%A0/blog/source/_posts/5G协议/5G-NR-PUSCH学习/p8-PTRS1.png" alt></p><h4 id="3-2-1-2-频域索引"><a href="#3-2-1-2-频域索引" class="headerlink" title="3.2.1.2 频域索引"></a>3.2.1.2 频域索引</h4><p>(与PDSCH PTRS 几乎一样)<br>首先，假定分配给PUSCH的RB为从0到$N_{RB}-1$，那么分配给PUSCH的子载波范围就是0-$N_{sc}^{RB}N_{RB}-1$。最终PTRS频域索引$k$，由下面公式得到：</p><script type="math/tex;mode=display">k=k_{ref}^{RE}+(iK_{PT-RS}+k_{ref}^{RB})N_{sc}^{RB}\\k_{ref}^{RB}= \begin{cases}n_{RNTI}modK_{PT-RS} \quad \quad \quad if N_{RB}modK_{PT-RS} = 0 \\n_{RNTI}mod(N_{RB}modK_{PT-RS})\quad \quad otherwise\end{cases}</script><p>$k_{ref}^{RE}$ 由下表获得[TS 38.211-Table 6.4.1.2.2-1]：</p><p><img src="/5G%E5%8D%8F%E8%AE%AE/5G-NR-PUSCH%E5%AD%A6%E4%B9%A0/blog/source/_posts/5G协议/5G-NR-PUSCH学习/t5-211 6.4.1.2.2.1-1.png" alt></p><p>由上可知，$K_{PT-RS}$为相邻 PTRS之间间隔的RB数，即相邻 PTRS之间相差$K_{PT-RS}\cdot N_{sc}^{RB}$ 个子载波，第一个PTRS 子载波定位是 $k_{ref}^{RE}+（0K_{PT-RS}+k_{ref}^{RB}）N_{sc}^{RB}$ 。大概的图样如下图所示：</p><p><img src="/5G%E5%8D%8F%E8%AE%AE/5G-NR-PUSCH%E5%AD%A6%E4%B9%A0/blog/source/_posts/5G协议/5G-NR-PUSCH学习/PTRS频域图.png" alt></p><h3 id="3-2-2-Transform-Precoding-enabled"><a href="#3-2-2-Transform-Precoding-enabled" class="headerlink" title="3.2.2 Transform Precoding enabled"></a>3.2.2 Transform Precoding enabled</h3><p>此种情况PTRS是在DFT之前插入，插入的位置m与三个参数有关：PTRS的group数量，每个group内的sample数量和PUSCH所占子载波的数量，不同情况下的具体公式在下表中给出：</p><p><img src="/5G%E5%8D%8F%E8%AE%AE/5G-NR-PUSCH%E5%AD%A6%E4%B9%A0/blog/source/_posts/5G协议/5G-NR-PUSCH学习/t6-211 6.4.1.2.2.2-1.png" alt></p><blockquote><p>参考目录<br>微信公众号：春天工作室，5G菜鸟成长日记<br>网页：<a href="https://mp.weixin.qq.com/s/83D25ABb2YURSbLQ3fOYsg" target="_blank" rel="noopener">https://mp.weixin.qq.com/s/83D25ABb2YURSbLQ3fOYsg</a><br>网页：<a href="https://mp.weixin.qq.com/s/SZwf4bJEzWa8RfJDiCC-CA" target="_blank" rel="noopener">https://mp.weixin.qq.com/s/SZwf4bJEzWa8RfJDiCC-CA</a><br>网页：<a href="http://www.sharetechnote.com/html/5G/5G_PUSCH.html" target="_blank" rel="noopener">http://www.sharetechnote.com/html/5G/5G_PUSCH.html</a><br>网页：<a href="http://www.sharetechnote.com/html/5G/5G_PUSCH_TxMode.html" target="_blank" rel="noopener">http://www.sharetechnote.com/html/5G/5G_PUSCH_TxMode.html</a><br>博客：<a href="https://blog.csdn.net/kakamilan/article/details/104759214/" target="_blank" rel="noopener">https://blog.csdn.net/kakamilan/article/details/104759214/</a> （DMRS）<br>博客：<a href="https://blog.csdn.net/m0_45416816/article/details/105097130" target="_blank" rel="noopener">https://blog.csdn.net/m0_45416816/article/details/105097130</a> （PTRS）</p></blockquote></div><div><div><br><br><div style="text-align:center;color:#ccc;font-size:14px">----------- 本文结束 -----------</div><br><br><br><br></div></div><footer class="post-footer"><div class="post-tags"><a href="/tags/PUSCH/" rel="tag"><i class="fa fa-tag">PUSCH</i></a></div><div class="post-widgets"><div id="needsharebutton-postbottom"><span class="btn"><i class="fa fa-share-alt" aria-hidden="true"></i></span></div></div><div class="post-nav"><div class="post-nav-next post-nav-item"><a href="/5G%E5%8D%8F%E8%AE%AE/5G-NR-PUCCH%E5%AD%A6%E4%B9%A0/" rel="next" title="5G-NR-PUCCH学习"><i class="fa fa-chevron-left"></i> 5G-NR-PUCCH学习</a></div><span class="post-nav-divider"></span><div class="post-nav-prev post-nav-item"><a href="/5G%E5%8D%8F%E8%AE%AE/5G-NR-%E5%8F%82%E8%80%83%E4%BF%A1%E5%8F%B7%E5%AD%A6%E4%B9%A0/" rel="prev" title="5G-NR-参考信号学习">5G-NR-参考信号学习 <i class="fa fa-chevron-right"></i></a></div></div></footer></div></article><div class="post-spread"></div></div></div></div><div class="sidebar-toggle"><div class="sidebar-toggle-line-wrap"><span class="sidebar-toggle-line sidebar-toggle-line-first"></span> <span class="sidebar-toggle-line sidebar-toggle-line-middle"></span> <span class="sidebar-toggle-line sidebar-toggle-line-last"></span></div></div><aside id="sidebar" class="sidebar"><div class="sidebar-inner"><ul class="sidebar-nav motion-element"><li class="sidebar-nav-toc sidebar-nav-active" data-target="post-toc-wrap">文章目录</li><li class="sidebar-nav-overview" data-target="site-overview-wrap">站点概览</li></ul><section class="site-overview-wrap sidebar-panel"><div class="site-overview"><div class="site-author motion-element" itemprop="author" itemscope itemtype="http://schema.org/Person"><a href="/"><img class="site-author-image" itemprop="image" src="/images/logo.jpg" alt="从之丶"></a><p class="site-author-name" itemprop="name">从之丶</p><p class="site-description motion-element" itemprop="description"></p></div><nav class="site-state motion-element"><div class="site-state-item site-state-posts"><a href="/archives/%7C%7C%20archive"><span class="site-state-item-count">24</span> <span class="site-state-item-name">日志</span></a></div><div class="site-state-item site-state-categories"><a href="/categories/index.html"><span class="site-state-item-count">6</span> <span class="site-state-item-name">分类</span></a></div><div class="site-state-item site-state-tags"><a href="/tags/index.html"><span class="site-state-item-count">25</span> <span class="site-state-item-name">标签</span></a></div></nav><div class="links-of-author motion-element"><span class="links-of-author-item"><a href="https://github.com/czGitAccount" target="_blank" title="GitHub"><i class="fa fa-fw fa-github"></i>GitHub</a> </span><span class="links-of-author-item"><a href="mailto:caoz326@163.com" target="_blank" title="E-Mail"><i class="fa fa-fw fa-envelope"></i>E-Mail</a></span></div><div class="links-of-blogroll motion-element links-of-blogroll-block"><div class="links-of-blogroll-title"><i class="fa fa-history fa-" aria-hidden="true"></i> 近期文章</div><ul class="links-of-blogroll-list"><li class="recent_posts_li"><a href="/Data_Structure_and_Algorithm/%E5%89%91%E6%8C%87offer/%E6%95%B0%E5%AD%A6/" title="剑指offer -- 数学" target="_blank">剑指offer -- 数学</a></li><li class="recent_posts_li"><a href="/Data_Structure_and_Algorithm/%E5%89%91%E6%8C%87offer/%E6%90%9C%E7%B4%A2%E4%B8%8E%E5%9B%9E%E6%BA%AF%E7%AE%97%E6%B3%95/" title="剑指offer -- 搜索与回溯算法" target="_blank">剑指offer -- 搜索与回溯算法</a></li><li class="recent_posts_li"><a href="/Data_Structure_and_Algorithm/%E5%89%91%E6%8C%87offer/%E6%8E%92%E5%BA%8F/" title="剑指offer -- 排序" target="_blank">剑指offer -- 排序</a></li><li class="recent_posts_li"><a href="/Data_Structure_and_Algorithm/%E5%89%91%E6%8C%87offer/%E6%A8%A1%E6%8B%9F/" title="剑指offer -- 模拟" target="_blank">剑指offer -- 模拟</a></li><li class="recent_posts_li"><a href="/Data_Structure_and_Algorithm/%E5%89%91%E6%8C%87offer/%E4%BD%8D%E8%BF%90%E7%AE%97/" title="剑指offer -- 位运算" target="_blank">剑指offer -- 位运算</a></li></ul></div></div></section><section class="post-toc-wrap motion-element sidebar-panel sidebar-panel-active"><div class="post-toc"><div class="post-toc-content"><ol class="nav"><li class="nav-item nav-level-1"><a class="nav-link" href="#1-PUSCH信道处理流程"><span class="nav-text">1 PUSCH信道处理流程</span></a><ol class="nav-child"><li class="nav-item nav-level-2"><a class="nav-link" href="#1-1-TS-38-212对应处理过程"><span class="nav-text">1.1 TS 38.212对应处理过程</span></a><ol class="nav-child"><li class="nav-item nav-level-3"><a class="nav-link" href="#1-1-1-增加CRC校验"><span class="nav-text">1.1.1 增加CRC校验</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#1-1-2-LDPC-base-graph-selection"><span class="nav-text">1.1.2 LDPC base graph selection</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#1-1-3-Code-block-码块分割和增加CRC"><span class="nav-text">1.1.3 Code block 码块分割和增加CRC</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#1-1-4-信道编码"><span class="nav-text">1.1.4 信道编码</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#1-1-5-速率匹配"><span class="nav-text">1.1.5 速率匹配</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#1-1-6-码块串联"><span class="nav-text">1.1.6 码块串联</span></a></li></ol></li><li class="nav-item nav-level-2"><a class="nav-link" href="#1-2-TS-38-211对应处理过程"><span class="nav-text">1.2 TS 38.211对应处理过程</span></a><ol class="nav-child"><li class="nav-item nav-level-3"><a class="nav-link" href="#1-2-1-加扰"><span class="nav-text">1.2.1 加扰</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#1-2-2-调制"><span class="nav-text">1.2.2 调制</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#1-2-3-层映射"><span class="nav-text">1.2.3 层映射</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#1-2-4-变换预编码"><span class="nav-text">1.2.4 变换预编码</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#1-2-5-预编码"><span class="nav-text">1.2.5 预编码</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#1-2-6-映射到VRB"><span class="nav-text">1.2.6 映射到VRB</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#1-2-7-映射到PRB"><span class="nav-text">1.2.7 映射到PRB</span></a></li></ol></li></ol></li><li class="nav-item nav-level-1"><a class="nav-link" href="#2-PUSCH-DMRS"><span class="nav-text">2 PUSCH DMRS</span></a><ol class="nav-child"><li class="nav-item nav-level-2"><a class="nav-link" href="#2-1-序列生成"><span class="nav-text">2.1 序列生成</span></a><ol class="nav-child"><li class="nav-item nav-level-3"><a class="nav-link" href="#2-1-1-Transform-Precoding-disabled"><span class="nav-text">2.1.1 Transform Precoding disabled</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#2-1-2-Transform-Precoding-enabled"><span class="nav-text">2.1.2 Transform Precoding enabled</span></a></li></ol></li><li class="nav-item nav-level-2"><a class="nav-link" href="#2-2-资源映射"><span class="nav-text">2.2 资源映射</span></a><ol class="nav-child"><li class="nav-item nav-level-3"><a class="nav-link" href="#2-2-1-频域索引"><span class="nav-text">2.2.1 频域索引</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#2-2-2-时域索引"><span class="nav-text">2.2.2 时域索引</span></a></li></ol></li><li class="nav-item nav-level-2"><a class="nav-link" href="#2-3-天线端口问题"><span class="nav-text">2.3 天线端口问题</span></a></li></ol></li><li class="nav-item nav-level-1"><a class="nav-link" href="#3-PUSCH-PTRS"><span class="nav-text">3 PUSCH PTRS</span></a><ol class="nav-child"><li class="nav-item nav-level-2"><a class="nav-link" href="#3-1-序列生成"><span class="nav-text">3.1 序列生成</span></a><ol class="nav-child"><li class="nav-item nav-level-3"><a class="nav-link" href="#3-1-1-Transform-Precoding-disabled"><span class="nav-text">3.1.1 Transform Precoding disabled</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#3-1-2-Transform-Precoding-enabled"><span class="nav-text">3.1.2 Transform Precoding enabled</span></a></li></ol></li><li class="nav-item nav-level-2"><a class="nav-link" href="#3-2-资源映射"><span class="nav-text">3.2 资源映射</span></a><ol class="nav-child"><li class="nav-item nav-level-3"><a class="nav-link" href="#3-2-1-Transform-Precoding-disabled"><span class="nav-text">3.2.1 Transform Precoding disabled</span></a><ol class="nav-child"><li class="nav-item nav-level-4"><a class="nav-link" href="#3-2-1-1-时域索引"><span class="nav-text">3.2.1.1 时域索引</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#3-2-1-2-频域索引"><span class="nav-text">3.2.1.2 频域索引</span></a></li></ol></li><li class="nav-item nav-level-3"><a class="nav-link" href="#3-2-2-Transform-Precoding-enabled"><span class="nav-text">3.2.2 Transform Precoding enabled</span></a></li></ol></li></ol></li></ol></div></div></section></div></aside></div></main><footer id="footer" class="footer"><div class="footer-inner"><div class="copyright">&copy; <span itemprop="copyrightYear">2021</span> <span class="with-love"><i class="fa fa-user"></i> </span><span class="author" itemprop="copyrightHolder">从之丶</span></div></div></footer><div class="back-to-top"><i class="fa fa-arrow-up"></i> <span id="scrollpercent"><span>0</span>%</span></div><div id="needsharebutton-float"><span class="btn"><i class="fa fa-share-alt" aria-hidden="true"></i></span></div></div><script type="text/javascript">"[object Function]"!==Object.prototype.toString.call(window.Promise)&&(window.Promise=null)</script><script type="text/javascript" src="/lib/jquery/index.js?v=2.1.3"></script><script type="text/javascript" src="/lib/fastclick/lib/fastclick.min.js?v=1.0.6"></script><script type="text/javascript" src="/lib/jquery_lazyload/jquery.lazyload.js?v=1.9.7"></script><script type="text/javascript" src="/lib/velocity/velocity.min.js?v=1.2.1"></script><script type="text/javascript" src="/lib/velocity/velocity.ui.min.js?v=1.2.1"></script><script type="text/javascript" src="/lib/fancybox/source/jquery.fancybox.pack.js?v=2.1.5"></script><script type="text/javascript" src="/lib/canvas-nest/canvas-nest.min.js"></script><i id="darkmode" class="fa fa-lightbulb-o" aria-hidden="true"></i><script>var body=$("body"),darkmode=$("#darkmode");(matchMedia("(prefers-color-scheme: dark)").matches||"1"===localStorage.getItem("darkmode"))&&"1"!==localStorage.getItem("noDark")&&body.addClass("dark"),body.hasClass("dark")?darkmode.removeClass("fa-moon-o").addClass("fa-lightbulb-o"):darkmode.removeClass("fa-lightbulb-o").addClass("fa-moon-o"),darkmode.click(function(){body.hasClass("dark")?(darkmode.removeClass("fa-lightbulb-o").addClass("fa-moon-o"),body.removeClass("dark"),localStorage.setItem("darkmode","0"),localStorage.setItem("noDark","1")):(darkmode.removeClass("fa-moon-o").addClass("fa-lightbulb-o"),body.addClass("dark"),localStorage.setItem("darkmode","1"),localStorage.setItem("noDark","0"))})</script><script type="text/javascript" src="/js/src/utils.js?v=5.1.4"></script><script type="text/javascript" src="/js/src/motion.js?v=5.1.4"></script><script type="text/javascript" src="/js/src/scrollspy.js?v=5.1.4"></script><script type="text/javascript" src="/js/src/post-details.js?v=5.1.4"></script><script type="text/javascript" src="/js/src/clipboard.min.js?v=5.1.4"></script><script type="text/javascript" src="/js/src/highlight-wrap.js?v=5.1.4"></script><script type="text/javascript" src="/js/src/bootstrap.js?v=5.1.4"></script><script type="text/javascript">function proceedsearch(){$("body").append('<div class="search-popup-overlay local-search-pop-overlay"></div>').css("overflow","hidden"),$(".search-popup-overlay").click(onPopupClose),$(".popup").toggle();var t=$("#local-search-input");t.attr("autocapitalize","none"),t.attr("autocorrect","off"),t.focus()}var isfetched=!1,isXml=!0,search_path="search.xml";0===search_path.length?search_path="search.xml":/json$/i.test(search_path)&&(isXml=!1);var path="/"+search_path,onPopupClose=function(t){$(".popup").hide(),$("#local-search-input").val(""),$(".search-result-list").remove(),$("#no-result").remove(),$(".local-search-pop-overlay").remove(),$("body").css("overflow","")},searchFunc=function(t,e,o){"use strict";$("body").append('<div class="search-popup-overlay local-search-pop-overlay"><div id="search-loading-icon"><i class="fa fa-spinner fa-pulse fa-5x fa-fw"></i></div></div>').css("overflow","hidden"),$("#search-loading-icon").css("margin","20% auto 0 auto").css("text-align","center"),$.ajax({url:t,dataType:isXml?"xml":"json",async:!0,success:function(t){isfetched=!0,$(".popup").detach().appendTo(".header-inner");var n=isXml?$("entry",t).map(function(){return{title:$("title",this).text(),content:$("content",this).text(),url:$("url",this).text()}}).get():t,r=document.getElementById(e),s=document.getElementById(o),a=function(){var t=r.value.trim().toLowerCase(),e=t.split(/[\s\-]+/);e.length>1&&e.push(t);var o=[];if(t.length>0&&n.forEach(function(n){function r(e,o,n,r){for(var s=r[r.length-1],a=s.position,i=s.word,l=[],h=0;a+i.length<=n&&0!=r.length;){i===t&&h++,l.push({position:a,length:i.length});var p=a+i.length;for(r.pop();0!=r.length&&(s=r[r.length-1],a=s.position,i=s.word,p>a);)r.pop()}return c+=h,{hits:l,start:o,end:n,searchTextCount:h}}function s(t,e){var o="",n=e.start;return e.hits.forEach(function(e){o+=t.substring(n,e.position);var r=e.position+e.length;o+='<b class="search-keyword">'+t.substring(e.position,r)+"</b>",n=r}),o+=t.substring(n,e.end)}var a=!1,i=0,c=0,l=n.title.trim(),h=l.toLowerCase(),p=n.content.trim().replace(/<[^>]+>/g,""),u=p.toLowerCase(),f=decodeURIComponent(n.url),d=[],g=[];if(""!=l&&(e.forEach(function(t){function e(t,e,o){var n=t.length;if(0===n)return[];var r=0,s=[],a=[];for(o||(e=e.toLowerCase(),t=t.toLowerCase());(s=e.indexOf(t,r))>-1;)a.push({position:s,word:t}),r=s+n;return a}d=d.concat(e(t,h,!1)),g=g.concat(e(t,u,!1))}),(d.length>0||g.length>0)&&(a=!0,i=d.length+g.length)),a){[d,g].forEach(function(t){t.sort(function(t,e){return e.position!==t.position?e.position-t.position:t.word.length-e.word.length})});var v=[];0!=d.length&&v.push(r(l,0,l.length,d));for(var $=[];0!=g.length;){var C=g[g.length-1],m=C.position,x=C.word,w=m-20,y=m+80;0>w&&(w=0),y<m+x.length&&(y=m+x.length),y>p.length&&(y=p.length),$.push(r(p,w,y,g))}$.sort(function(t,e){return t.searchTextCount!==e.searchTextCount?e.searchTextCount-t.searchTextCount:t.hits.length!==e.hits.length?e.hits.length-t.hits.length:t.start-e.start});var T=parseInt("1");T>=0&&($=$.slice(0,T));var b="";b+=0!=v.length?"<li><a href='"+f+"' class='search-result-title'>"+s(l,v[0])+"</a>":"<li><a href='"+f+"' class='search-result-title'>"+l+"</a>",$.forEach(function(t){b+="<a href='"+f+'\'><p class="search-result">'+s(p,t)+"...</p></a>"}),b+="</li>",o.push({item:b,searchTextCount:c,hitCount:i,id:o.length})}}),1===e.length&&""===e[0])s.innerHTML='<div id="no-result"><i class="fa fa-search fa-5x" /></div>';else if(0===o.length)s.innerHTML='<div id="no-result"><i class="fa fa-frown-o fa-5x" /></div>';else{o.sort(function(t,e){return t.searchTextCount!==e.searchTextCount?e.searchTextCount-t.searchTextCount:t.hitCount!==e.hitCount?e.hitCount-t.hitCount:e.id-t.id});var a='<ul class="search-result-list">';o.forEach(function(t){a+=t.item}),a+="</ul>",s.innerHTML=a}};r.addEventListener("input",a),$(".local-search-pop-overlay").remove(),$("body").css("overflow",""),proceedsearch()}})};$(".popup-trigger").click(function(t){t.stopPropagation(),isfetched===!1?searchFunc(path,"local-search-input","local-search-result"):proceedsearch()}),$(".popup-btn-close").click(onPopupClose),$(".popup").click(function(t){t.stopPropagation()}),$(document).on("keyup",function(t){var e=27===t.which&&$(".search-popup").is(":visible");e&&onPopupClose()})</script><link rel="stylesheet" href="/lib/needsharebutton/needsharebutton.css"><script src="/lib/needsharebutton/needsharebutton.js"></script><script>pbOptions={},pbOptions.iconStyle="box",pbOptions.boxForm="horizontal",pbOptions.position="bottomCenter",pbOptions.networks="Weibo,Wechat,Douban,QQZone,Twitter,Facebook",new needShareButton("#needsharebutton-postbottom",pbOptions),flOptions={},flOptions.iconStyle="box",flOptions.boxForm="horizontal",flOptions.position="middleRight",flOptions.networks="Weibo,Wechat,Douban,QQZone,Twitter,Facebook",new needShareButton("#needsharebutton-float",flOptions)</script><script type="text/x-mathjax-config">MathJax.Hub.Config({
        tex2jax: {
          inlineMath: [ ['$','$'], ["\\(","\\)"]  ],
          processEscapes: true,
          skipTags: ['script', 'noscript', 'style', 'textarea', 'pre', 'code']
        }
      });</script><script type="text/x-mathjax-config">MathJax.Hub.Queue(function() {
        var all = MathJax.Hub.getAllJax(), i;
        for (i=0; i < all.length; i += 1) {
          all[i].SourceElement().parentNode.className += ' has-jax';
        }
      });</script><script type="text/javascript" src="//cdn.bootcss.com/mathjax/2.7.1/latest.js?config=TeX-AMS-MML_HTMLorMML"></script><script src="/live2dw/lib/L2Dwidget.min.js?094cbace49a39548bed64abff5988b05"></script><script>L2Dwidget.init({pluginRootPath:"live2dw/",pluginJsPath:"lib/",pluginModelPath:"assets/",tagMode:!1,debug:!1,model:{jsonPath:"/live2dw/assets/wanko.model.json"},display:{position:"left",width:200,height:270},mobile:{show:!1},log:!1})</script></body></html><!-- rebuild by neat -->